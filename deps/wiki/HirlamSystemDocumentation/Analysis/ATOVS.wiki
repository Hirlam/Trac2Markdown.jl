[[PageOutline]]

[[Center(begin)]]
== '''Hirlam System Documentation''' ==
= '''Assimilation of ATOVS data''' =
[[Center(end)]]

= Preview of the HIRVDA ATOVS Assimilation module update =
''(to be introduced in 7.1 alpha 4, due in Dec 2006)''

The implementation of ATOVS in HIRVDA has been upgraded.
This affects the user in several ways. First, there are now
new namelist variables "llrtmnoaa15amsua" etc. available.
Secondly, the bccf and dbt (btcm) files are now history,
and are replaced by one rtmsys for each satellite/instrument
combination. The user now also has software integrated in
the bias processing for plotting the effects of the bias
coefficients directly.

The new software allows the user to easily define which
channels to use for which surface type (through the rtmsys file).
The user may also use different bias correction predictors 
for different surface types. 

The data structure has been completely re-programmed so
the system can now allow different observations to have different
number of channels without allocating more memory than necessary
for the observations with fewer channels. 

An optional bias quality control has been added. The residual bias in the bias-
corrected innovation is calculated for a cycle, and if this
residual bias is greater than a given limit, the bias correction
is rejected (and so are all the corresponding channel-observations).
This is a greatly missed feature in earlier versions of the system
as experience shows that it is very easy to neglect the monitoring and
updating of the ATOVS bias correction coefficients.

A optional dynamic innovation check has also been added. The idea
behind this innovation quality control is that any non-Normal elements
of the innovation probability distribution originates from the observations.
Bayesian Risk theory is then applied to find the limits for when using
an observation, under the assumption that it has a Normal error distribution,
gives a negative risk contribution.

= Introduction =

The ATOVS term is used to describe the set of sounder instruments flown on
for instance the noaa satellite series. The sounder instruments are designed to
provide information about the temperature and humidity profiles of the atmosphere.

The ATOVS instruments on for instance noaa16 are the passive microwave sounders
amsu-a and amsu-b, and the infrared sounder hirs/3. The amsu-a instrument operates
in the lower microwave range, while amsu-b operates in the higher range, and is
therefore more sensitive to cloud contamination.

HIRLAM 3D-var is currently capable of assimilating amsu-a observations successfully
over open sea. Experiments are also ongoing for assimilating amsu-b over open sea
and amsu-a over sea ice. There have also been experiments to assimilate HIRS over
open sea, but some tuning still remains before this option can be used operationally.

The amsu-a observations made by the noaa satellites can be received free of charge
by using a local antenna, or members of EUMETSAT may receive the observations
free of charge through the EUMETSAT retransmission service EARS. This service
collects locally received data at different locations in Europe, processes the data
using AAPP (EUMETSAT free software) to level 1B, and distributes the data freely.

= Preprocessing =

The starting point for the processing chain in HIRLAM is level amsu-a level 1c pass
files (one per pass over each receiving station). Amsu-a level 1c pass files can be 
created from EUMETSAT ears l1c_bufr files using for instance: {{{AAPP_6/AAPP/src/tools/bin/aapp_decodebufr_1c.ksh}}} in the EUMETSAT AAPP package.

The level 1c pass files should first be processed individually to ASCII files using the 
read_1c.pl perl script (developed and maintained by Bjarne Amstrup at DMI). The ASCII file can be converted to
2a files one by one using the program [wiki:HirlamHowto/Man/hitmerge7 hitmerge7].
The 2a files should then be processed together by [wiki:HirlamHowto/Man/landx landx] so that data is gathered
in one file relevant to each assimilation cycle. These 2a files should finally be converted
to BUFR files by [wiki:HirlamHowto/Man/hitmerge7 hitmerge7]. These ATOVS BUFR files are input to HIRLAM 3D-VAR.

= Using ATOVS observations in HIRLAM 3DVAR =

In addition to the ATOVS observations, HIRLAM 3D-Var also needs information about the ATOVS bias correction, 
the observation error, the innovation limits, channel selected for each surface type etc. 
There are many possible ways to run the system, and it would have 
been very confusing to use a static namelist to give the user control of them all. Such a namelist would probably 
have to contain some thousand elements. A set of flexible rtm-system files are used instead.
The user must still specify which satellite/instrument combinations that should be used through the namelists,
and the HIRLAM will then read the corresponding {{{rtmsys}}} files. For instance if "LLRTM=.TRUE." and 
"LLRTMNOAA15AMSUA=.TRUE." is set in the preprocessing  "&obstypes" namelist, HIRLAM will request the following 
{{{rtmsys}}} file {{{noaa15amsu-a_rtmsys.dat}}}.
 
The information put into the {{{rtmsys}}} file determines how 3DVAR will process that ATOVS satellite/instrument combination. For instance,
 * If there is no predictor list specified (for a given surface type), then the corresponding observations will be 
   completely ignored (not even the forward model is applied).
 * If there are noe bias correction coefficients, innovations are calculated and put into the ACMA file for later 
   use by [wiki:HirlamHowto/Man/rtmcmaextr rtmcmaextr.x] and [wiki:HirlamHowto/Man/rtmsys rtmsys.x] to generate bias coefficients. 
   The observations are ignored in the assimilation.
 * If there are no observation errors available, the innovations are calculated and put into the ACMA file, 
   but the ATOVS observations are not assimilated.

The {{{rtmsys}}} files are created by a program called  [wiki:HirlamHowto/Man/rtmsys rtmsys.x]. 
This program can create templates that do not contain any bias correction data etc. 
The program can also maintain and update the bias correction, the bias correction quality control parameters and 
the innovation limit check parameters.
The observation error and which channels to use for which surface types must be edited manually in the {{{rtmsys}}} file.
Note that it is usually easier to edit the template rather than the processed {{{rtmsys}}} file, since the processed
file contains bias coefficient tables that must be consistent with the number of predictors chosen for the specified 
surface type.

Earlier version (<7.1) of the ATOVS processing system used two system files: the {{{bccf}}} files and the {{{btcm}}} files.
The bccf files were controlled by the {{{bccf}}} index file (usually called {{{bccf.index}}}). The {{{bccf}}} files were
generated by the program [wiki:HirlamHowto/Man/mkbccf mkbccf]. There was no program available for generating 
the observation error matrix files ({{{btcm}}}), and these files were usually generated by trial and error. 
Existing files were used as templates.
HIRLAM ignored ATOVS observations that did not have a corresponding {{{dbt}}}-file. 
A complete reference guide to the earlier version of the ATOVS processing system is available 
[wiki:HirlamHowto/Man/ATOVS70 here]

HIRLAM 3D-Var uses a forward model to simulate the ATOVS observations from model
fields, that is called RTTOV. The RTTOV model uses a series of coefficient files, typically
{{{rtcoef_noaa_15_amsua.dat}}}. The current version of RTTOV is 8.
The rttov version is set in {{{hirlam/Makefile SYSTEM := rttov8}}} and
{{{hirlam/scripts/Env_expdesc RTTOVVERSION=8}}}.

The relevant ATOVS BUFR must be concatenated into a file named "ATOVIO01".
Further in the namelist "&NAMBUFR" we must have "LATOVF(1)=.TRUE." in order
for OBSPROC to put the ATOVS data into the CMA array.
HIRLAM 3D-Var must have "LLRTM=.TRUE.," in the namelist "&obstypes" in the files
prepobstypes.dat, scrobstypes.dat and minobstypes.dat. 
The different satellite/instrument combinations are activated by for instance setting
LLRTMNOAA15AMSUA=.TRUE..
Note that if LLRTM is false
in prepobstypes.dat, but not the other files, the system will abort.


The following files must be available for HIRLAM 3D-Var:
 *   {{{emis.dat}}}                   (OPTIONAL emissivity file, generated by [wiki:HirlamHowto/Man/hitmerge7 hitmerge.x])
 *   {{{noaa15amsu-a_rtmsys.dat}}}    (ATOVS system file, maintained by user and [wiki:HirlamHowto/Man/rtmsys rtmsys.x])
 *   {{{<...>}}}
 *   {{{rtcoef_noaa_15_amsua.dat}}}   (RTTOV8 coefficient file, comes with rttov8)
 *   {{{<...>}}}
 
Note that the old RTTOV7 coefficient files have the same name as the new RTTOV8 coefficient files, 
and if you mix these files up, the system will crash in a strange way.

The ATOVS innovation data is available in the ACMA file generated by HIRLAM 3D-Var.
The ACMA file is processed by [wiki:HirlamHowto/Man/rtmcmaextr rtmcmaextr] to generate 
rtm.raw files which are used
by [wiki:HirlamHowto/Man/rtmsys rtmsys] to update the {{{rtmsys}}} files.
In order to generate innovation data in the ACMA file, _you already need a rtmsys file_. 
The [wiki:HirlamHowto/Man/rtmsys rtmsys] program can be used to generate a template for you.
Run HIRLAM on an appropriate period without assimilating the data (but with a template 
{{{rtmsys}}} file available) while you store the ACMA files. 
Next create your rtm.raw ATOVS innovation files by using [wiki:HirlamHowto/Man/rtmcmaextr rtmcmaextr.x]. 
Finally update your {{{rtmsys}}} files by using the program [wiki:HirlamHowto/Man/rtmsys rtmsys.x].

= Generating Bias Correction Coefficients using  [wiki:HirlamHowto/Man/rtmsys rtmsys] =

There are large biases between the observed brightness temperatures in the different 
ATOVS channels and the corresponding brightness temperatures calculated by the forward 
model using the model first guess. The difference between observation and equivalent calculated from
the first guess is normally referred to as the 'innovation'.
It can be shown that it is not optimal to assimilate observations with a bias in the innovation.
The bias is therefore removed during the HIRVDA pre-processing, before the ATOVS observations are used
in the minimisation.
Several 'predictors' are available (for instance instrument scan angle) for determinining the nature 
of the bias, so the bias correction procedure can remove unwanted systematic effects.

If you are starting to use a new satellite/instrument combination, you may need to generate
new bias correction coefficients. The procedure is to generate ATOVS innovation data for a
representative period of time (without assimilating ATOVS data, just pre-processing it), and 
then analyse the innovations using [wiki:HirlamHowto/Man/rtmsys rtmsys] which estimates the
bias correction coefficients and updates the rtmsys files. The innovation data is extracted from
the ACMA file using [wiki:HirlamHowto/Man/rtmcmaextr rtmcmaextr.x], which generates a file rtm_raw.dat. The rtm_raw file is
in ASCII and contains the location, time, observed-, calculated- brightness temperatures and
all corresponding predictors. The file will also include the calculated brightness temperatures
based on the analysis and the bias corrected observation if the observation was assimilated.

First you will need to generate a rtmsys file template, that you will use during your initial
period when you are only pre-processing the ATOVS observations, and not assimilating them.
Let us assume that you want to generate a template for satellite noaa15, instrument amsu-a.
Remember to delete any existing rtmsys file called {{{noaa15amsu-a_rtmsys.dat}}}.
We use the [wiki:HirlamHowto/Man/rtmsys rtmsys.x] program to generate a new template,
by using the commands
{{{
rm -f noaa15amsu-a_rtmsys.dat
rtmsys.x << EOF
# specify the name of the satellite and instrument
SATELLITE AND INSTRUMENT [1]VFLR
  noaa15 amsu-a
# tell the program that you want to create a template
CREATE TEMPLATE IF NO RTMSYS FILE IS AVAILABLE[0]VFMLR
EOF
}}}
A template for the {{{noaa15amsu-a_rtmsys.dat}}} file (generated by [wiki:HirlamHowto/Man/rtmsys rtmsys])
typically looks like this:
{{{
#
RTMSYS V1.0 RTTOV8 [0]VFMLR
SATELLITE [1]VFMLR
noaa15
INSTRUMENT [1]VFMLR
amsu-a
CHANNEL INDEX FOR USED CHANNELS [*]VFMLR
          1
          2
          3
          4
          5
          6
          7
          8
          9
         10
         11
         12
         13
         14
         15
PREDICTOR INDEX FOR USED PEDICTORS [*]VFMLR
   Constant  
   ScanAngle 
   ScanAnlge2
   # Latitude  
   # T0m       
   # Channel 6 
   # Int WatV  
   # T300-1000 
   # T50-200   
   # T321-840  
   # T56-194   
LATITUDE RANGE, BIAS STDV AND BIAS COEFFICIENTS FOR EACH CHANNEL USED [*]VFMLR
        0.000      5.000 No data available.
        5.000     65.000 No data available.
       65.000     90.000 No data available.
MAX ABS ALLOWED BIAS RESIDUAL (IN STDV) PER CYCLE FOR EACH CHANNEL USED [*]VFMLR
        1.000
        1.000
        1.000
        1.000
        1.000
        1.000
        1.000
        1.000
        1.000
        1.000
        1.000
        1.000
        1.000
        1.000
        1.000
MAX AND MIN INNOVATION FOR EACH CHANNEL USED [*]VFMLR
    -9999.990   9999.990      0.000
    -9999.990   9999.990      0.000
    -9999.990   9999.990      0.000
    -9999.990   9999.990      0.000
    -9999.990   9999.990      0.000
    -9999.990   9999.990      0.000
    -9999.990   9999.990      0.000
    -9999.990   9999.990      0.000
    -9999.990   9999.990      0.000
    -9999.990   9999.990      0.000
    -9999.990   9999.990      0.000
    -9999.990   9999.990      0.000
    -9999.990   9999.990      0.000
    -9999.990   9999.990      0.000
    -9999.990   9999.990      0.000
OBSERVATION ERROR FOR EACH CHANNEL USED [*]VFMLR
     9999.990
     9999.990
     9999.990
     9999.990
     9999.990
     9999.990
     9999.990
     9999.990
     9999.990
     9999.990
     9999.990
     9999.990
     9999.990
     9999.990
     9999.990
#
THE FOLLOWING SETTINGS APPLY TO SEA SURFACES [0]
#
THE FOLLOWING SETTINGS APPLY TO LAND SURFACES [0]
#
THE FOLLOWING SETTINGS APPLY TO ICE SURFACES [0]
#
THE FOLLOWING SETTINGS APPLY TO OTHER SURFACES [0]
#
}}}

The template file should be used in your initial period run to extract ATOVS innovation data. 
Set the namelist variables and provide the RTTOV system files as described above, 
in particular make sure you have set LLRTMNOAA15AMSUA=.TRUE. in the preprocessing 
"&obstypes" namelist and .FALSE. in the minimisation namelist.
Run your initial experiment period and use rtmcmaextr.x to generate the rtm_raw files containing
the innovations, and store these files.


Next you may want to edit the template rtmsys file so that your preferred channels and predictors for
the different surface types are specified. 
The first lines in the template file above tell us which version of the file this is, which
satellite and instrument it is valid for.
There are several surface categories (open sea, land etc.), and
the parameters at the beginning of the file are valid for all surface categories.
The channel index indicates which channels should be considered,
and the predictor index specifies the predictors to be used in the bias correction.
The latitude band, bias stdv and bias correction coefficients that follow are
used to bias correct the observations so that they match with the first guess.
The bias stdv is used in the bias quality control to reject the bias correction
when the residual bias in each cycle is too large (stdv multiplied by a factor).
The innovation check limits and bias correction coefficients are maintained 
by the rtmsys program. The innovation check limits are based on the assumption that
any non-Normal contribution to the innovation probability distribution originates
from the observation, and the rejection limits are found by using Bayesian Risk theory 
(the risk of using a non-Normal observation while you assume that it is Normal).
The innovation limits also come with a constant bias coefficient.
The observation errors must be specified by the user

The values found below {{{THE FOLLOWING SETTINGS APPLY TO SEA SURFACES }}} are only 
valid for that surface category etc.

For details on which channels to use for different instruments and surface
types, and what observation error to give the observations, the user should
consult the hirlam ATOVS user community. At the moment of writing we only 
recommend using channels 1 to 10 for amsu-a over open sea. The recommended 
observation error is {300.0, 300.0, 300.0, 30.0, 0.35, 0.35, 0.35, 0.7, 1.4, 30.0}.
It is recommended to only use the "Constant", "ScanAngle" and "ScanAngle2" 
predictors. The latitude bands should split at about 65 degrees.

When you are done editing the template file, you can finally update it with new 
bias correction coefficients by using 
[wiki:HirlamHowto/Man/rtmsys rtmsys.x] again, this time with an input file like
{{{
# the next line lists all possible headers:
   x

# specify the name of the satellite and instrument (mandatory)
SATELLITE AND INSTRUMENT [1]VFLR
  noaa15 amsu-a

# list of the rtm_raw files that were generated by rtmcmaextr.x
RTM-RAW FILES [*]VFMLR
 rtm_raw.out.today
 rtm_raw.out.yesterday
 rtm_raw.out.yesterdays.yesterday

# the list can also be put into a file, for instance one called "filelist"
#! ls rtm_raw.out* > filelist
#include(filelist)

# inform the system of which channels you want to use over Ocean (default is all)
 ONLY USE THESE CHANNELS OVER OCEAN [*]VFLR
    4
    5
    6
    7

# do not abort if some of the input files are corrupt
DO NOT ABORT AT CORRUPT FILES [0]VFMLR

# set the following flag if you want to update bias correction coefficients
REDO BIAS CORRECTION [0]VFMLR

# set the following flag if you want to update the innovation limits
REDO INNOVATION QC [0]VFMLR

#OUTPUT BIAS POSTSCRIPT FILE (SATINS,CH,PCAT) [1]VFLR
#  testSATINS_CH_PCAT.ps

CREATE TEMPLATE IF NO RTMSYS FILE IS AVAILABLE[0]VFMLR

# set the maximum number of stdv the cycle residual bias is allowed to deviate
TEMPLATE RESIDUAL BIAS QC LIMITS (IN STDV) [1] VFLR
  1.5

#TEMPLATE OBSERVATION ERROR [1]VFLR
#  999.0 

#TEMPLATE (TWO) LATITUDES FOR SPLITTING BIAS CORRECTION [1]VFLR
#  20.0 60.0

# the stop command stops reading the input file and starts the processing
stop
# here follows a list of headers for easy reference (which will not be processed)
 RTMSYS V1.0 [0]VFMLR
 SATELLITE AND INSTRUMENT [1]VFLR &
 RTM-RAW FILES [*]VFMLR
 DO NOT ABORT AT CORRUPT FILES [0]VFMLR
 MOST RECENT NO OF DAYS USED [1]VFMLR
 DATA REDUCTION FACTOR [1]VFLR
 RTMSYS INDEX FILE[1]VFMLR
 RTMSYS FILE DIRECTORY [1]VFLR
 OUTPUT BIAS POSTSCRIPT FILE (SATINS, CH) [1]VFLR
 DO NOT PLOT LEGEND [0]
 DO NOT PLOT BARS [0]VFMLR
 REDO BIAS CORRECTION [0]VFMLR
 REDO INNOVATION QC [0]VFMLR
 DO NOT SHIFT THE BIAS IN THE INNOVATION QC [0]
 OPTIMAL INNOVATION QC STDV CROP FACTOR [1]VFLR
 INNOVATION QC GROSS ERROR Q AND S-FACTOR [1]VFLR
 CREATE TEMPLATE IF NO RTMSYS FILE IS AVAILABLE[0]VFMLR
 TEMPLATE RESIDUAL BIAS QC LIMITS (IN STDV) [1] VFLR
 TEMPLATE OBSERVATION ERROR [1]VFLR
 TEMPLATE (TWO) LATITUDES FOR SPLITTING BIAS CORRECTION [1]VFLR
 DO NOT USED DATA OVER OCEAN [0]VFMLR
 DO NOT USED DATA OVER LAND [0]VFMLR
 DO NOT USED DATA OVER SEA-ICE [0]VFMLR
 DO NOT USED DATA OVER OTHER [0]VFMLR
 ONLY USE THESE CHANNELS OVER OCEAN [*]VFLR
 ONLY USE THESE CHANNELS OVER LAND [*]VFLR
 ONLY USE THESE CHANNELS OVER SEA-ICE [*]VFLR
 ONLY USE THESE CHANNELS OVER OTHER [*]VFLR
}}}
If everything worked as intended, you should now have updated your rtmsys file
with new bias correction coefficients. The system is now ready to assimilate noaa15 amsu-a
data. To do this, finally set LLRTMNOAA15AMSUA=.TRUE. in the minimisation "&obstypes" namelist.

If you are already using ATOVS data operationally, you may update your bias correction coefficients
(in the rtmsys files) on the 'fly'. You may then update the rtmsys files using, say, the last 
30 days of innovation data.

= Example =

Assimilating ATOVS successfully gives entries in the HIRVDA log similar to:
{{{
...
 RTM_REPC    satellite:noaa15   Instrument:amsu-a       Count:    9495
 RTM_REPC    satellite:noaa16   Instrument:amsu-a       Count:    4870 ### IGNORED
...
 IORTME          Opening file:emis.dat
 IORTME          Emissivities read: 1796
...
 RTMIOSYS    Reading RTMSYS-file:noaa15amsu-a_rtmsys.dat

 PREPARE_RTM_MOD Surface cat:open sea
 PREPARE_RTM_MOD Total number of obs:          182
 PREPARE_RTM_MOD Land/ice mask:                  0 (  0.0%)
 PREPARE_RTM_MOD RTTOV failed:                   0 (  0.0%)
 PREPARE_RTM_MOD Gross error:                    0 (  0.0%)
 PREPARE_RTM_MOD Cloud mask:                   -65 ( 35.7%)
 PREPARE_RTM_MOD FORMARDRAD failed:              0 (  0.0%)
 PREPARE_RTM_MOD - - - - - - - - - - - -
 PREPARE_RTM_MOD Accepted for BCCF:            117
 PREPARE_RTM_MOD No bias cor. available:         0 (  0.0%)
 PREPARE_RTM_MOD Extreme innovation:             0 (  0.0%)
 PREPARE_RTM_MOD Elevated surface:               0 (  0.0%)
 PREPARE_RTM_MOD -----------------------
 PREPARE_RTM_MOD Accepted for analysis:        117

 PREPARE_RTM_MOD Rejected:                      65 ( 35.7% of      182)
 PREPARE_RTM_MOD Ignored in analysis:            0 (  0.0% of      117)

PREPARE_RTM_MOD Surface:open sea LatBand { 20.0- 60.0} Sat:noaa15 Instr:amsu-a
  Ch:  1 Mu(Y-HXb):    3.24 Std(Y-HXb):    3.02 (bc: Mu    0.16 <     4.27, Std:    2.34) Cnt:  117
  Ch:  2 Mu(Y-HXb):    4.16 Std(Y-HXb):    4.36 (bc: Mu    0.58 <     4.71, Std:    2.36) Cnt:  117
  Ch:  3 Mu(Y-HXb):    4.52 Std(Y-HXb):    2.26 (bc: Mu    0.37 <     3.29, Std:    1.46) Cnt:  117
  Ch:  4 Mu(Y-HXb):    0.08 Std(Y-HXb):    0.48 (bc: Mu    0.03 <     0.80, Std:    0.29) Cnt:  117
  Ch:  5 Mu(Y-HXb):    0.02 Std(Y-HXb):    0.22 (bc: Mu   -0.03 <     1.14, Std:    0.22) Cnt:  117
  Ch:  6 Mu(Y-HXb):   -0.76 Std(Y-HXb):    0.19 (bc: Mu    0.09 <     1.11, Std:    0.30) Cnt:  117
  Ch:  7 Mu(Y-HXb):    0.27 Std(Y-HXb):    0.26 (bc: Mu    0.10 <     0.80, Std:    0.31) Cnt:  117
  Ch:  8 Mu(Y-HXb):   -0.10 Std(Y-HXb):    0.27 (bc: Mu    0.08 <     0.70, Std:    0.28) Cnt:  117
  Ch:  9 Mu(Y-HXb):   -0.69 Std(Y-HXb):    0.30 (bc: Mu    0.01 <     0.54, Std:    0.20) Cnt:  117
  Ch: 10 Mu(Y-HXb):   -1.27 Std(Y-HXb):    0.54 (bc: Mu   -0.05 <     0.81, Std:    0.37) Cnt:  117
  Ch: 11 Mu(Y-HXb): -135.05 Std(Y-HXb):    0.88 (bc: Mu   -1.41 <     4.30, Std:    2.02) Cnt:  117
  Ch: 12 Mu(Y-HXb):    3.15 Std(Y-HXb):    0.83 (bc: Mu    0.14 <     2.86, Std:    1.18) Cnt:  117
  Ch: 13 Mu(Y-HXb):    5.22 Std(Y-HXb):    0.45 (bc: Mu    0.10 <     2.52, Std:    1.16) Cnt:  117
  Ch: 14 Mu(Y-HXb): -162.82 Std(Y-HXb):    0.99 (bc: Mu   -0.03 <     0.25, Std:    0.07) Cnt:  117
  Ch: 15 Mu(Y-HXb):    8.25 Std(Y-HXb):    4.39 (bc: Mu    0.14 <     8.14, Std:    3.29) Cnt:  117

...
 RTM_THINN  Satellite: noaa15    Instrument: amsu-a
 RTM_THINN  Total number of obs:          427
 RTM_THINN  Thinned:                     -199 ( 46.6%)
 RTM_THINN -------------------------------------------
 RTM_THINN  Accepted:                     228
...
--------------- RTM Cost function contributions -------------------------------
 noaa15   amsu-a       open sea ch: 1  Jrtm=      0.0005 (Jbias=  0.0003 ) active:  136
 noaa15   amsu-a       open sea ch: 2  Jrtm=      0.0007 (Jbias=  0.0004 ) active:  136
 noaa15   amsu-a       open sea ch: 3  Jrtm=      0.0004 (Jbias=  0.0002 ) active:  136
 noaa15   amsu-a       open sea ch: 4  Jrtm=      0.0000 (Jbias=  0.0000 ) active:  136
 noaa15   amsu-a       open sea ch: 5  Jrtm=      0.0001 (Jbias=  0.0000 ) active:  136
 noaa15   amsu-a       open sea ch: 6  Jrtm=      0.0000 (Jbias=  0.0000 ) active:  136
 noaa15   amsu-a       open sea ch: 7  Jrtm=      0.0000 (Jbias=  0.0000 ) active:  136
 noaa15   amsu-a       open sea ch: 8  Jrtm=      0.0000 (Jbias=  0.0000 ) active:  136
 noaa15   amsu-a       open sea ch: 9  Jrtm=      0.0000 (Jbias=  0.0000 ) active:  136
 noaa15   amsu-a       open sea ch:10  Jrtm=      0.0000 (Jbias=  0.0000 ) active:  136
 noaa15   amsu-a       open sea ch:11  Jrtm=      0.0003 (Jbias=  0.0002 ) active:  136
 noaa15   amsu-a       open sea ch:12  Jrtm=      0.0001 (Jbias=  0.0001 ) active:  136
 noaa15   amsu-a       open sea ch:13  Jrtm=      0.0001 (Jbias=  0.0001 ) active:  136
 noaa15   amsu-a       open sea ch:14  Jrtm=      0.0000 (Jbias=  0.0000 ) active:  136
 noaa15   amsu-a       open sea ch:15  Jrtm=      0.0018 (Jbias=  0.0009 ) active:  136
 noaa15   amsu-a       land     ch: 1  Jrtm=      0.0017 (Jbias=  0.0009 ) active:   92
 noaa15   amsu-a       land     ch: 2  Jrtm=      0.0020 (Jbias=  0.0011 ) active:   92
 noaa15   amsu-a       land     ch: 3  Jrtm=      0.0001 (Jbias=  0.0001 ) active:   92
 noaa15   amsu-a       land     ch: 4  Jrtm=      0.0000 (Jbias=  0.0000 ) active:   92
 noaa15   amsu-a       land     ch: 5  Jrtm=      0.0000 (Jbias=  0.0000 ) active:   92
 noaa15   amsu-a       land     ch: 6  Jrtm=      0.0000 (Jbias=  0.0000 ) active:   92
 noaa15   amsu-a       land     ch: 7  Jrtm=      0.0000 (Jbias=  0.0000 ) active:   92
 noaa15   amsu-a       land     ch: 8  Jrtm=      0.0000 (Jbias=  0.0000 ) active:   92
 noaa15   amsu-a       land     ch: 9  Jrtm=      0.0000 (Jbias=  0.0000 ) active:   92
 noaa15   amsu-a       land     ch:10  Jrtm=      0.0000 (Jbias=  0.0000 ) active:   92
 noaa15   amsu-a       land     ch:11  Jrtm=      0.0000 (Jbias=  0.0000 ) active:   92
 noaa15   amsu-a       land     ch:12  Jrtm=      0.0000 (Jbias=  0.0000 ) active:   92
 noaa15   amsu-a       land     ch:13  Jrtm=      0.0001 (Jbias=  0.0001 ) active:   92
 noaa15   amsu-a       land     ch:14  Jrtm=      0.0000 (Jbias=  0.0000 ) active:   92
 noaa15   amsu-a       land     ch:15  Jrtm=      0.0003 (Jbias=  0.0002 ) active:   92
 -------------------------------------------------------------------------------
 Total (no rep:  247)               Jrtm=     0.008222 active: 3420
...
}}}

Note that in the example above, an un-naturally low weight has been given to the observations
in the {{{rtmsys}}} file (template default). 
Note also that there were many time-slots and surface categories that were not listed 
thus causing apparent inconsistencies in the number of observations in the log.

There was also a bug in the land/sea classification scheeme, causing sea observations to be classified as being over land. 
These misclassified observations were then mostly rejected by the cloud mask, giving an unnaturally high rejection rate of cloud contaminated observations.
The correct cloud contamination rejection rate should be around 5 %.

= Technical details =

The HIRLAM variational assimilation has an incremental formulation and the full non-linear observation operator is applied to the background state. A tangent linear version of the observation operator ( linearized around the background state) is applied to the assimilation increments. 

In grid-point space, first carry out a horizontal 2-dimensional bi-linear interpolation to the horizontal positions of the observations. (In a MPP environment this step involves messages passing, since the model fields are split horizontally between processors and also the observation might be located on a processor different than the model field equivalent). Then, at the horizontal positions of the observations, calculate pressure at model full levels. Finally carry out vertical interpolation (to RTTOV levels), linearly in the logarithm of pressure (for details see Gustafsson et al., 1999). 

Normally, when describing the handling of a certain observation type and its observation operator, one can divide the code into two parts:
The preparation part which is where the innovation vectors are calculated
Screening part where the data quality control takes place.
ATOVS data is a bit more complicated than that. Data selection takes place in both the preparation and the screening part of the code. The preparation and screening parts of the code will be described below.

== Descrition of the interface to the observation operator, RTTOV. Preparation part. ==

This is where the innovation-vectors are calculated and  where the observation operator, RTTOV, is called. 
Prior to all prepare calculations, a special routine, rtmcalc_ini (rtmcalc8ini/rtmcalc7ini in the upgraded version), is called just to initialize the RTTOV model. At the same time, the observation errors and bias correction coefficients are read into memory from separate ascii files (one ASCII file in the upgraded version).

For every observation, the footprint size is calculated as a function of instrument scan-angle, and the grid-points located inside the footprint are determined. The surface type of each grid-point is then checked and if they all have surface type as open sea, the observation is said be over open sea. If one grid-point has surface type as land, the obs is said be over land, and if no grid-points are land and at least one is ice, the obs is said to be over sea ice. 
If data is over land , it is rejected, and that is controlled in an if-statement and cannot be set via namelist. (in the upgraded version, data over land is not rejected automatically, but it will anyway be rejected during cloud masking as there is no cloud mask implemented for observations over land).

Surface emissivities to be used over ice can be read from a separate file into memory, but this is optional.

The RTTOV model has its own vertical levels that stretches up to 0.1hPa. The HIRLAM model top is at 10hPa. So when interpolating the background profiles to the RTTOV levels, climate profiles are used to fill in the gap between 10 and 0.1 hPa. (Climatlogy will also be used if the surface pressure is higher than the highest RTTOV pressure level).There are separate climate profiles for summer and winter time, arctic and sub-arctic conditions respectively. The climate profiles used are a combination of the four, based on the date and the latitude of the observation.

When RTTOV is called, it calculates the background brightness temperatures as well as the jacobians, i.e. the tangent linear observation operator, which are stored in memory. RTTOV is thus not called in the minimization loop.  


There are also scattering, or cloud, checks done right after the call to RTTOV. For AMSU-A observations over sea, the total cloud liquid water is calculated using a routine from NOAA/NESDIS. It takes as input the instrument scan-angle, background estimates of channels 1 and 2, observed values of channels 1 and 2.



The observations are bias-corrected and the innovation vectors are computed.

AMSU-A over seaice utilizes an innovation-vector check with special determined limits to indicate scattering contamination (in the upgraded version, this innovation check is available for all surface types and instruments). The innovation limits are determined by the same program which updates the bias correction coefficients. The theory for determining the innovation limits is based on Bayesian decision theory, It is assumed that the non-Gaussian form of the innovation probability distribution originates from the observations (i.e. that the first guess error is Gaussian), and observations are rejected or used based on Risk estimates of using the non-Gaussian observation under the assumption that it is Gaussian. The purpose of the innovation check is to remove observations that are affected by clouds (which skews the observation error probability distribution).

== Data screening ==
Before minimization, the ATOVS data undergo a screening procedure that consists of:

First guess check: Data is rejected if the innovation is too big. The limits for rejection are set in namelist.

Multi channel check: If the sum of the first guess check flags from all used channels is greater than a certain value, the whole report is rejected. This test has to switched on via namelist, by default it is not done. 

There is no blacklist for ATOVS.

Thinning: This is based on the method used in the ECMWF implementation. The area is divided into boxes, and all observations in each box is assigned a value of preference. That value is a combination of how close the observation is to the analysis time and how close to nadir (zero scan-angle) it is. For each box, the one with the best value of preference is kept. This procedure is repeated three times, for three different box sizes.

Thinning update: New thinning algorithm is based on a "tree" sorting algorithm giving accurate thinning distances and using the same penalty function as the previous ECMWF implementation.


== Status of observations ==
 *   AMSU-A over ocean: operational
 *   AMSU-A over sea ice: Implemented but not operational. Depends on sea ice data from OSI SAF.
 *   AMSU-A over land: Implemented in recently upgraded version but is rejected since cloud cover check algorithm is not completed.
 *   AMSU-B: ???? Per?
 *   HIRS: Implemented and tested, but no positive impact, so not operational

== ATOVS data in the ACMA array ==

|| __Term__           || __Symbol__ || __ACMA Index__                                || __HIRLAM local variable__  ||
|| Raw observations   ||          Y || NCMVAR i.e. preport(ioffset+ncmvar)           || rtm_obs_list(num)%bt(i)    ||
|| Bias corrected obs ||       Ybc  || NCMFGC2 i.e. preport(ioffset+ncmfgc2)    || rtm_obs_list(num)%btbc(i)  ||
|| Analysis increment || HXa-Ybc    || NCMOMN i.e. preport(ioffset+ncmomn) || rtm_obs_list(num)%dbtan(i) ||
|| First guess        || Hxb        || NCMFGC1 i.e. preport(ioffset+ncmfgc1)         || rtm_obs_list(num)%btbg(i)  ||

== Variational Bias Correction (VARBC) ==

The Variational Bias Correction (VARBC) option has now been implemented for ATOVS observations. To activate this option you must change
the file {{{namrtmvar.dat}}} (created by {{{scripts/VARinput}}}) which contains the namelist {{{namrtmvar}}} so that {{{rtm_lvarbc=.true.}}}.

Then you have to edit your {{{rtmsys}}} files and specify which predictors should have bias coefficients that should be adjusted during minimisation,
and which errors you expect the coefficients have. The relevant header is
{{{PREDICTOR INDEX FOR USED PEDICTORS AND ASSOCIATED VARBC ERROR}}}
and you specify the error by inserting it after the predictor in the corresponding data body.
For instance 
{{{
PREDICTOR INDEX FOR USED PEDICTORS AND ASSOCIATED VARBC ERROR [*]VFMLR
   Constant 999.0
   ScanAngle
   ScanAnlge2
}}}
allows an adjustment of the coefficient multiplied with the "Constant" predictor (always 1.0), with an assumed error of 999.0 (Kelvin, for this predictor) 
in the coefficient first guess. Note that if you adjust coefficients associated with other predictors, you must scale your error to fit the predictor (for instance Kelvin/deg if your predictor is "ScanAngle").

A printout of the log for a case where VARBC was off (first panel) and on (second panel) shows that using VARBC gives a reduction of the RTM-contribution to the cost function (Jrtm) by about 30%. The contribution to Jrtm from bias is reduced dramatically, as expected.


No VARBC, iteration 75:
{{{
--------------- RTM Cost function contributions -------------------------------
 noaa16   amsu-b       open sea ch: 1  Jrtm=      0.0003 (Jbias=  0.3114%) active: 1208
 noaa16   amsu-b       open sea ch: 2  Jrtm=      0.0001 (Jbias=  0.7349%) active: 1208
 noaa16   amsu-b       open sea ch: 3  Jrtm=    262.4682 (Jbias=  2.7536%) active: 1208
 noaa16   amsu-b       open sea ch: 4  Jrtm=    280.3984 (Jbias=  0.5997%) active: 1208
 noaa16   amsu-b       open sea ch: 5  Jrtm=    374.2635 (Jbias=  6.6593%) active: 1208
 noaa17   amsu-b       open sea ch: 1  Jrtm=      0.0001 (Jbias=  2.6128%) active:  426
 noaa17   amsu-b       open sea ch: 2  Jrtm=      0.0001 (Jbias=  0.3971%) active:  426
 noaa17   amsu-b       open sea ch: 3  Jrtm=     37.3476 (Jbias=  4.6791%) active:  426
 noaa17   amsu-b       open sea ch: 4  Jrtm=     41.9808 (Jbias= 10.7055%) active:  426
 noaa17   amsu-b       open sea ch: 5  Jrtm=     63.5342 (Jbias=  2.7255%) active:  426
 noaa18   amsu-a       open sea ch: 1  Jrtm=      0.0001 (Jbias=  0.2879%) active: 1273
 noaa18   amsu-a       open sea ch: 2  Jrtm=      0.0001 (Jbias=  1.7662%) active: 1273
 noaa18   amsu-a       open sea ch: 3  Jrtm=      0.0000 (Jbias=  0.9816%) active: 1273
 noaa18   amsu-a       open sea ch: 4  Jrtm=    124.0195 (Jbias=  1.9472%) active: 1273
 noaa18   amsu-a       open sea ch: 5  Jrtm=    100.1172 (Jbias=  1.1715%) active: 1273
 noaa18   amsu-a       open sea ch: 6  Jrtm=     38.3984 (Jbias=  3.9490%) active: 1273
 noaa18   amsu-a       open sea ch: 7  Jrtm=     55.4605 (Jbias=  2.7353%) active: 1273
 noaa18   amsu-a       open sea ch: 8  Jrtm=     77.0279 (Jbias=  0.5239%) active: 1273
 noaa18   amsu-a       open sea ch: 9  Jrtm=     33.9320 (Jbias=  3.0356%) active: 1273
 noaa18   amsu-a       open sea ch:10  Jrtm=     34.9629 (Jbias=  6.8107%) active: 1273
 noaa18   amsu-a       sea ice  ch: 1  Jrtm=      0.0000 (Jbias=  0.0001%) active:   75
 noaa18   amsu-a       sea ice  ch: 2  Jrtm=      0.0000 (Jbias= 21.3745%) active:   75
 noaa18   amsu-a       sea ice  ch: 3  Jrtm=      0.0000 (Jbias= 49.3931%) active:   75
 noaa18   amsu-a       sea ice  ch: 4  Jrtm=      0.0000 (Jbias=  1.6853%) active:   75
 noaa18   amsu-a       sea ice  ch: 5  Jrtm=      0.0000 (Jbias=  1.3486%) active:   75
 noaa18   amsu-a       sea ice  ch: 6  Jrtm=      0.3916 (Jbias=  2.1148%) active:   75
 noaa18   amsu-a       sea ice  ch: 7  Jrtm=      3.2706 (Jbias= 22.2806%) active:   75
 noaa18   amsu-a       sea ice  ch: 8  Jrtm=      3.9164 (Jbias=  9.5958%) active:   75
 noaa18   amsu-a       sea ice  ch: 9  Jrtm=      1.7216 (Jbias= 18.6189%) active:   75
 noaa18   amsu-a       sea ice  ch:10  Jrtm=      3.3270 (Jbias= 54.1619%) active:   75
 noaa18   mhs          open sea ch: 1  Jrtm=      0.0005 (Jbias=  2.1286%) active: 1499
 noaa18   mhs          open sea ch: 2  Jrtm=      0.0001 (Jbias=  4.0364%) active: 1499
 noaa18   mhs          open sea ch: 3  Jrtm=    152.6521 (Jbias= 14.4413%) active: 1499
 noaa18   mhs          open sea ch: 4  Jrtm=    127.2058 (Jbias=  6.1114%) active: 1499
 noaa18   mhs          open sea ch: 5  Jrtm=    203.3516 (Jbias=  0.2489%) active: 1499
 metop-2  amsu-a       open sea ch: 1  Jrtm=      0.0000 (Jbias= 10.8227%) active:  156
 metop-2  amsu-a       open sea ch: 2  Jrtm=      0.0000 (Jbias=  4.1140%) active:  156
 metop-2  amsu-a       open sea ch: 3  Jrtm=      0.0000 (Jbias=  0.8452%) active:  156
 metop-2  amsu-a       open sea ch: 4  Jrtm=     23.7689 (Jbias=  8.0425%) active:  156
 metop-2  amsu-a       open sea ch: 5  Jrtm=     20.1082 (Jbias= 37.9725%) active:  156
 metop-2  amsu-a       open sea ch: 6  Jrtm=     10.1045 (Jbias=  4.6771%) active:  156
 metop-2  amsu-a       open sea ch: 7  Jrtm=     89.8880 (Jbias= 72.6536%) active:  156
 metop-2  amsu-a       open sea ch: 8  Jrtm=     43.0864 (Jbias= 79.5398%) active:  156
 metop-2  amsu-a       open sea ch: 9  Jrtm=     15.0876 (Jbias= 45.2306%) active:  156
 metop-2  amsu-a       open sea ch:10  Jrtm=      7.6933 (Jbias= 27.9687%) active:  156
 metop-2  mhs          open sea ch: 1  Jrtm=      0.0001 (Jbias=  0.4662%) active:  295
 metop-2  mhs          open sea ch: 2  Jrtm=      0.0000 (Jbias=  1.6368%) active:  295
 metop-2  mhs          open sea ch: 3  Jrtm=     25.6505 (Jbias= 23.8337%) active:  295
 metop-2  mhs          open sea ch: 4  Jrtm=     21.7764 (Jbias= 10.4267%) active:  295
 metop-2  mhs          open sea ch: 5  Jrtm=     31.1995 (Jbias=  1.0449%) active:  295
 -------------------------------------------------------------------------------
 Total (no rep: 4932)               Jrtm=  2308.112638 active:32180
}}}

VARBC on, iteration 75:
{{{
--------------- RTM Cost function contributions -------------------------------
 noaa16   amsu-b       open sea ch: 1  Jrtm=      0.0003 (Jbias=  0.0333%) active: 1208
 noaa16   amsu-b       open sea ch: 2  Jrtm=      0.0001 (Jbias=  0.2716%) active: 1208
 noaa16   amsu-b       open sea ch: 3  Jrtm=    198.5300 (Jbias=  0.0792%) active: 1208
 noaa16   amsu-b       open sea ch: 4  Jrtm=    224.8911 (Jbias=  0.0313%) active: 1208
 noaa16   amsu-b       open sea ch: 5  Jrtm=    279.3433 (Jbias=  0.0270%) active: 1208
 noaa17   amsu-b       open sea ch: 1  Jrtm=      0.0001 (Jbias=  1.6847%) active:  426
 noaa17   amsu-b       open sea ch: 2  Jrtm=      0.0001 (Jbias=  1.3724%) active:  426
 noaa17   amsu-b       open sea ch: 3  Jrtm=     19.4798 (Jbias=  0.3889%) active:  426
 noaa17   amsu-b       open sea ch: 4  Jrtm=     23.1373 (Jbias=  1.7228%) active:  426
 noaa17   amsu-b       open sea ch: 5  Jrtm=     39.6129 (Jbias=  0.3069%) active:  426
 noaa18   amsu-a       open sea ch: 1  Jrtm=      0.0001 (Jbias=  1.4754%) active: 1273
 noaa18   amsu-a       open sea ch: 2  Jrtm=      0.0001 (Jbias=  2.6101%) active: 1273
 noaa18   amsu-a       open sea ch: 3  Jrtm=      0.0000 (Jbias=  1.6773%) active: 1273
 noaa18   amsu-a       open sea ch: 4  Jrtm=    102.8814 (Jbias=  0.0400%) active: 1273
 noaa18   amsu-a       open sea ch: 5  Jrtm=     77.1368 (Jbias=  0.0197%) active: 1273
 noaa18   amsu-a       open sea ch: 6  Jrtm=     28.1592 (Jbias=  0.0053%) active: 1273
 noaa18   amsu-a       open sea ch: 7  Jrtm=     44.1277 (Jbias=  0.0022%) active: 1273
 noaa18   amsu-a       open sea ch: 8  Jrtm=     60.5873 (Jbias=  0.0006%) active: 1273
 noaa18   amsu-a       open sea ch: 9  Jrtm=     22.2719 (Jbias=  0.2271%) active: 1273
 noaa18   amsu-a       open sea ch:10  Jrtm=     21.5973 (Jbias=  0.0136%) active: 1273
 noaa18   amsu-a       sea ice  ch: 1  Jrtm=      0.0000 (Jbias=  0.0053%) active:   75
 noaa18   amsu-a       sea ice  ch: 2  Jrtm=      0.0000 (Jbias= 21.2335%) active:   75
 noaa18   amsu-a       sea ice  ch: 3  Jrtm=      0.0000 (Jbias= 48.7640%) active:   75
 noaa18   amsu-a       sea ice  ch: 4  Jrtm=      0.0000 (Jbias=  0.1546%) active:   75
 noaa18   amsu-a       sea ice  ch: 5  Jrtm=      0.0000 (Jbias=  3.3296%) active:   75
 noaa18   amsu-a       sea ice  ch: 6  Jrtm=      0.2200 (Jbias=  2.4677%) active:   75
 noaa18   amsu-a       sea ice  ch: 7  Jrtm=      1.2311 (Jbias=  0.3235%) active:   75
 noaa18   amsu-a       sea ice  ch: 8  Jrtm=      1.8026 (Jbias=  0.1046%) active:   75
 noaa18   amsu-a       sea ice  ch: 9  Jrtm=      0.6761 (Jbias=  0.0028%) active:   75
 noaa18   amsu-a       sea ice  ch:10  Jrtm=      1.0676 (Jbias= 12.0871%) active:   75
 noaa18   mhs          open sea ch: 1  Jrtm=      0.0005 (Jbias=  2.9355%) active: 1499
 noaa18   mhs          open sea ch: 2  Jrtm=      0.0001 (Jbias=  4.9417%) active: 1499
 noaa18   mhs          open sea ch: 3  Jrtm=     92.7293 (Jbias=  0.2955%) active: 1499
 noaa18   mhs          open sea ch: 4  Jrtm=     96.2837 (Jbias=  0.0739%) active: 1499
 noaa18   mhs          open sea ch: 5  Jrtm=    164.1333 (Jbias=  0.0107%) active: 1499
 metop-2  amsu-a       open sea ch: 1  Jrtm=      0.0000 (Jbias=  5.2008%) active:  156
 metop-2  amsu-a       open sea ch: 2  Jrtm=      0.0000 (Jbias=  2.8844%) active:  156
 metop-2  amsu-a       open sea ch: 3  Jrtm=      0.0000 (Jbias=  0.0600%) active:  156
 metop-2  amsu-a       open sea ch: 4  Jrtm=     11.7309 (Jbias=  0.4358%) active:  156
 metop-2  amsu-a       open sea ch: 5  Jrtm=      7.4113 (Jbias=  0.2059%) active:  156
 metop-2  amsu-a       open sea ch: 6  Jrtm=      3.5882 (Jbias=  0.7649%) active:  156
 metop-2  amsu-a       open sea ch: 7  Jrtm=      9.4472 (Jbias=  0.0083%) active:  156
 metop-2  amsu-a       open sea ch: 8  Jrtm=      3.6977 (Jbias=  0.7603%) active:  156
 metop-2  amsu-a       open sea ch: 9  Jrtm=      3.0919 (Jbias=  4.0749%) active:  156
 metop-2  amsu-a       open sea ch:10  Jrtm=      3.1984 (Jbias=  0.9802%) active:  156
 metop-2  mhs          open sea ch: 1  Jrtm=      0.0001 (Jbias=  0.0622%) active:  295
 metop-2  mhs          open sea ch: 2  Jrtm=      0.0000 (Jbias=  0.1501%) active:  295
 metop-2  mhs          open sea ch: 3  Jrtm=     12.2118 (Jbias=  4.4213%) active:  295
 metop-2  mhs          open sea ch: 4  Jrtm=     11.6940 (Jbias=  0.0181%) active:  295
 metop-2  mhs          open sea ch: 5  Jrtm=     17.2462 (Jbias=  0.5221%) active:  295
 -------------------------------------------------------------------------------
 Total (no rep: 4932)               Jrtm=  1583.219213 active:32180
}}}

Note that turning on VARBC will probably cause the minimisation algorithm to use more iterations to converge (typically 5 iterations?)
even though the implementation is completely linear and gives a true quadratic contribution to the cost function.

== Bibliographical references ==

Amstrup, B., P. Dahlgren, H. Schyberg and F.T.Tveter, 2005: AMSU-A assimilation in HIRVDA – User Guide. March 2005.

Schyberg, H., T. Landelius, S. Thorsteinsson, F.T. Tveter, O. Vignes, B. Amstrup, N. Gustafsson, H. Jarvinen and M.Lindskog, 2003: Assimilation of ATOVS data in the HIRLAM 3D-Var system. HIRLAM Technical Report No 60, April 2003. Available on http://hirlam.org/open/publications/TechReports/TR60.pdf.

HIRLAM system documentation: Assimilation of ATOVS data. Available on HIRLAM internal webpages, https://hirlam.org/trac/wiki/HirlamSystemDocumentation/Analysis/ATOVS .


= Relevant links =

 * [wiki:HirlamHowto/Man/rtmsys rtmsys.x], creates and updates rtmsys files (containing bias coefficient etc.) used by hirvda.x.
 * [wiki:HirlamHowto/Man/hitmerge7 hitmerge7.x], can read and write "rtm.raw" files, BUFR, 2a and ASCII files.
 * [wiki:HirlamHowto/Man/landx landx.x], can "land-mask" ATOVS 2a-files, merge passes to single files, remove bad data etc.

 * [wiki:HirlamHowto/Man/nukem nukem], library used to read input file for the above ATOVS programs.

[[Center(begin)]]
[https://hirlam.org/trac/wiki/HirlamHowto See also the corresponding pages on HIRLAM Howto]
[[Center(end)]]

[[SubWiki]]

[[Center(begin)]]
[https://hirlam.org/trac/wiki/HirlamSystemDocumentation Back to the main page of the HIRLAM System Documentation]
[[Center(end)]]
----
[[Center(begin)]]
[[Disclaimer]]

[[Color(red, Last modified on)]] [[LastModified]]
[[Center(end)]]