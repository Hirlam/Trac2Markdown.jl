[[PageOutline]]

[[Center(begin)]]
== '''Hirlam System Documentation''' ==
= Use of O&SI SAF sea ice and surface temperature in HIRLAM 7.3 surface analysis =
[[Center(end)]]

== '''Introduction''' ==
Experiments with O&SI SAF sea ice and surface temperature in HIRLAMâ€™s surface analysis are documented in HIRLAM Newsletter 52. Compared to the experiments described in the Newsletter, there are some changes in the final implemented version as included in Hirlam 7.3, mainly affecting the SST and SIC fields over land. Here follows a short overview of the current version and some complementary details.

== '''How to get O&SI SAF MAPSST and ICE data''' ==
Product User Manuals are found at the [http://www.osi-saf.org/ O&SI SAF Web Site: http://www.osi-saf.org] 
where
SIC (Sea Ice Concentration)-files: ice_conc_nh_yyyymmdd1200.grb are available daily 
SST (Sea Surface Temperature)-files: SST12MAP_yyyymmddhh00.grb and QSST12MAP_yyyymmddhh00.grb are available twice daily

== '''Use of ECMWF SST and SIC''' ==
In previous versions of HIRLAM pseudo observations have been created from ECMWF SST on 2 deg. resolution and used in the successive correction analysis of SST. The ECMWF SST was found on the mf*.f-files, which have SST=0 over land and sharp gradients in the SST-values along the coast. The low values along the coasts and over land were avoided by checking ECMWF orography and land/sea mask and HIRLAM orography. 

The new version of HIRLAM uses ECMWF SST as pseudo observations when O&SI SAF SST is not available, and ECMWF SIC when O&SI SAF SIC not is available. The ECMWF SST and SIC is taken from the ma${prev}00m-file. This file has missing values over land and along the coasts. ECMWF SST and SIC are interpolated by the script Horint to the HIRLAM grid.

ECMWF SST is not only used as pseudo observations when O&SI SAF SST not is available. Instead of relaxing the background SST to a climate field, the background SST is relaxed to ECMWF SST over sea.

== '''Technical details''' ==
=== '''scripts/Env_expdesc''' ===
To use O&SI SAF SIC and SST the following lines have to be included in Env_expdesc
{{{
   SAFICE=yes                   # use OSISAF Sea Ice product
   ICETIME=:06:                 # Time(s) for updating Sea Ice
   SAFSST=yes                   # use OSISAF MAP SST product
   SSTTIME=:06:                 # Time(s) for SST analysis
}}}

=== '''scripts/Env_input''' ===

The location for O&SI-SAF observations is specified in Env_input
{{{
ICEDIR=${ICEDIR-ec:/hirlam/cis/obs/osisaf}    # ice_conc_nh files 
SSTDIR=${SSTDIR-ec:/hirlam/cis/obs/osisaf}    # SST12MAP files
}}}

=== '''scripts/SPAN''' ===

The variables set in Env_expdesc (defined above) are used in Span:
{{{
   If SAFICE=yes & it is time to update Sea Ice & ice_conc_nh-file is available,
        LSAFICE = .TRUE. 
        
   If SAFSST=yes & it is time to update SST & 
                               SST12MAP and QSST12MAP-files are available,
        LSAFSST = .TRUE. 
}}}
LSAFSST and LSAFICE are passed by the namelist COMSAF to the span routines.
 
=== '''Reading and use of SIC in the span-routines''' ===

If  LSAFICE = .TRUE. the subroutine safice read the ice_conc_nh-file. If the ice-file is OK, LSAFICE remains TRUE, if not LSAFICE=.FALSE.

If LSAFSIC = .FALSE., the SIC field is updated with ECMWF SIC if this field is available. ECMWF SIC interpolated to the HIRLAM grid by the script Horint is read in subroutine getbck, and is supposed to have missing values over land. 

Missing values along the coasts (FRL<0.7) are extrapolated from SIC over sea. Missing values over land are replaced by SIC values diagnosed from SST.

When neither O&SI SAF nor ECMWF SIC are available, SIC is diagnosed from SST in the subroutine diaice after the analyses of the surface parameters, in the same way as in the previous HIRLAM versions.

===  '''Reading and use of SST in the span-routines''' ===

If LSAFSST = .TRUE. the subroutine safsst read the MAP SST and quality flag files. If the files are OK, the observations (some of them) are included in the observation array POBS and LSAFSST remains TRUE. 

If LSAFSST = .FALSE., pseudo observations are created from ECMWF SST and included in POBS in the subroutine pseudo. ECMWF SST is read from the Hirlam grid in subroutine getbck, and is supposed to have missing values over land. In the subroutine pseudo the density of ECMWF SST pseudo observations is specified by JSTEPX and JSTEPY. JSTEPX=4 and JSTEPY=4 combined with 10km model resolution implies 40 km resolution of the pseudo observations.

'''Specification of background and observation error statistics'''  

The errors statistics is specified in subroutine setoip.
The background error correlation is modelled by a Gaussian structure function with R2=(0.8E5)**2. The observation errors of the O&SI SAF SST are supposed to be correlated, also modelled by a Gaussian function with slightly shorter influence radius, OER7=(0.5E5)**2. The observation errors of the pseudo ECMWF SST are also supposed to be correlated, modelled by a Gaussian function with influence radius, OER9=(0.65E5)**2. The OI analysis of SST is performed in 2 deg. * 2 deg. boxes. The analysis within each box includes observations also from neighbouring boxes. The box size of 2 deg. is adapted to the influence radii. 

'''Decimation and smoothing of MAP SST observations'''

The satellite sensors give observations of resolution about 10 km. Comparison of experiments using all observations and experiments with observations only from each second scan line, give results which are very close. The observations in each scan line have also been decimated. The MAP12SST observations are delivered on LAT/LON grid with resolution 0.1 deg., implying that the file contains redundant values in northern regions. Accordingly the current algorithm uses observations from each second scan line, and each second observation south of N65, each 3. between N65 and N75 and each 4. north of N75. Maximum number of observations in one box - NOBMX(JPSST) - is set to 1600, which is high enough for the specified observation density.

The observations are smoothed before decimation. One could probably benefit from more smoothing with model resolution above 10km.

'''Relaxation of background SST'''

The background SST in previous versions was relaxed to the climate SST fields. These fields seem to be too cold, and lead to too low temperatures, particularly along the coasts where there are no O&SI SAF observations. In the new version the background SST is relaxed to a field which is composed of ECMWF SST over sea and climate SST values over land. It would probably be even better to create new climate fields, e.g. based on ERA data as suggested by Nils G.

'''Potential use of NAR SST'''

It should be possible to substitute the MAP SST observations with other observations, e.g. NAR with small modifications:
 * in the subroutine safsst which read MAP SST  and quality flags from grib files
 * creation of pseudo observations / smoothing / thinning to obtain observation density in agreement with the specified error statistics, the box size of the OI analysis and the model resolution. 

== '''Contact''' ==
For questions and comments, please contact [mailto:mariken.homleid@met.no Mariken Homleid], met.no, the original author of this material.

[[Center(begin)]]
[https://hirlam.org/trac/wiki/HirlamSystemDocumentation Back to the main page of the HIRLAM-System Documentation]
[[Center(end)]]
----
[[Center(begin)]]
[[Disclaimer]]