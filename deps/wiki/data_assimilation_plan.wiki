[[Center(begin)]]
= '''Selected tasks for Data Assimilation development''' =
[[Center(end)]]

The following tasks were defined during the working week in Lisbon:

  - **4D-VAR:** (Nils, **Jan**, Magnus, Ole, Roohollah, Xiaohua) [Wednesday]: sanity check, radiance, Cloudy radiances,[[BR]]
    **Sanity check for 4D-Var system**[[BR]]
     - select a dynamic and convective case and run a single obs experiment (e.g. radio sonde) for the various domains (Magnus, Nils, Roel, Roohollah, Jelena, Jan, …).[[BR]]
     - comparison of the TL and the NL evolution of the analysis increment during the minimization (999 run) (Jan).[[BR]]
     - check whether important observation sets (radar) are used for the correct time slots and are used at all ( D radio sondes valid for 12 UTC are only available after 13 UTC) (Magnus, Nils, Roel, Roohollah, Jelena, Jan, …). [[BR]]
     - do we really run a coupled run (Alladin+Surfex) during the minimization? (Roohollah).[[BR]]
     - run validation experiments (Magnus, Jan,…). [[BR]]
      > Single observation experiments were performed by Nils, Mate and Jan [[BR]]
      > [https://hirlam.org/trac/attachment/wiki/data_assimilation_plan/WW-DA-Norrkoping.pdf Single profile of humidity] was assimilated by Roohollah [[BR]]
     - test the impact of tendency forcing (Jan,…). [[BR]]
    **2019-2020**[[BR]]
    **Design of 4DVAR**[[BR]]
    shorter term:[[BR]]
     - Use/check LSM in 4DVAR[[BR]]
     - check VARBC in the trajectory runs[[BR]]
     - Use/check surface analysis before 4DVminin[[BR]]
     - Implement a larger extension zone[[BR]]
     - Use of hessian information (warm start) for the 2nd loop[[BR]]
     - Flexibility in the observation window/hourly 4DVAR[[BR]]
     -Test single precision runs and 2d node architecture for 4DVAR[[BR]]
    longer term:[[BR]]
     - Remove the NL run from 4DVminim and use truncated versions of a full NL Arome run in 4DVminim (similar to ECMWF)[[BR]]
     - Use ECMWF physics (the package under LE* logicals) during the minimization[[BR]]
  - **VarQC:** (Nils, Roger, **Roel**)  [Tuesday] [[BR]]
     - VARQC settings can be made in NAMCOSJO (see src/arpifs/module/yomcosjo.F90)
     - M1QN3 is required to use VarQC in the minimization
  - **Correlated obs (time & spatial & inter-channel):** (**Magnus**, Roger, Jelena, Jan, Roohollah)  [Tuesday]
     - Diagnosis of spatial and time-correlated forecast errors (Obstool, Roohollah, from Patrick Bucanek Limitations of approach? Good starting point. Jan might come up with suggestions and ideas of improvements in current ongoing projects). Jelena has idea also to derive time correlated observation errors for radar. This has been tried at Univeristy of Reading for example. Also consider correlations between different satellite channels.[[BR]]
     - Use findings from diagnosis as a first step to overhaul thinning distances and it will as well guide averaging distances for super-observations of radar as well as crowd sourced data. [[BR]]
     - Apply findings from diagnosis on correlated errors between different channels. Overhauls of current research and tools available at ECMWF?[[BR]]
     - First crude method to take correlated observations errors into account in harmonie 4dvar is to modify sigmao. Magnus will investigate what has been done in IFS 4dvar for correlated observation errors at ECMWF and if we can apply that for surface pressure observations in HARMONIE 4D-Var to start with and later on also for other data.[[BR]]
     - Somebody to investigate framework for handling of correlated observation errors in parallel framework implemented by Gabor Radnoti at ECMWF. Later on how to link that to derived models for observation error correlations. Perhaps small local R matrix correlations between local stations.[[BR]]
     As pointed by Magnus [https://hirlam.org/trac/attachment/wiki/HarmonieWorkingWeek/UseofObsandALGO201812/corr_obs_error.pdf here].[[BR]]
  - **Cloudy radiances:** (**Roger**, Magnus, Joan, Roohollah) [Wednesday] [[BR]]
     - We plan to use the ECMWF physics in 4D-Var, which is not a simple task. Some works need to be done to make it available for Harmonie-Arome.[[BR]]
     - Run the non-linear part (ex. 4DScreen) with Harmonie-Arome, and the tangent linear and adjoint with the EC physics.[[BR]]
     - We can also produce regular outputs for the low resolution loops using FullPos.[[BR]]
     - Good point in this plan is that we have the ECMWF physics in minimisation to assimilate All-Sky radiances.[[BR]]
     - If things go well, in time it fits well with the Alertness project plan at MET Norway. So, we have manpower for this task.[[BR]]
  - **Handling of obs:** (**Joan**, **Eoin**, Martin, Mats, Jana, Bjarne, Sigurdur, Susanna, Maria, Magnus, Roger, Roel, Ronan, Jan) varbc, verif vs all obs, Crowdsourced obs,  [Tuesday]
     - Processing of radar (HDF5) data: An option to extend the prepopera.py script to produce radar data on ODB2 format and ultimately converted to an ECMA.radarv ODB suitable for NWP was discussed. Mats, Martin and Eoin discussed the possibilities and a prototype is being developed.
     - Magnus raised the issue VARBC predictors in the Harmonie system. Roel presented results analysis of IFS VARBC predictor correlations.
     - In preparation for an evaluation of low-peaking radiance channels (Sigurdur, Maria) it was agreed that the skin (surface) temperature from SURFEX should be included (blended) in the first-guess file for minimization.
     - The use (and blacklisting) of GPS-RO observations was discussed. It was agreed that a review of their use should be carried out.
     - The assimilation of SEVIRI radiances and, in particular, the data processing chain required to prepare these observations for Harmonie was discussed. Roger will provide more information to the group. Maria will contact with (AEMET) SAF-Nowcasting to explore the use of its products.
     - Crowd-source data, AI and machine-learning techniques were discussed. The challenges associated with the use of these data (based on presentations made at the wCROWN workshop hosted by DMI) were discussed. The merits of the using of pressure tendencies instead of pressure using nudging instead of variational techniques were also discussed.
     - The ''allObVer'' approach to verification was explained by Roger. See his presentation.
  - **Surface pressure assimilation:** (**Maria**, Pau, Eoin, Roel, Magnus, Sigurdur) [Wednesday afternoon]
     - A CY43 experiment has been shared and tested by the group. Bator code has been changed to write out P,,surf,, observations as well as Z from SYNOP. LISTE_LOC is used to blacklist SYNOP Z observations and a required change to the NOTVAR namelist is also used to ensure the assimialtion of P,,surf,,.
  - **Scatterometers:**  (**Isabel**, Jan, Eoin, Jana, Bjarne) [Tuesday]
     - The group discussed the assimilation of scatterometer winds, in particular ASCAT, in CY40. Concerns regarding thinning and the observation error setting were investigated.
     - The group group summarised some useful ASCAT information on the [wiki:HarmonieSystemDocumentation/ObservationHowto/Ascat wiki]
  - **CY43:** (**Eoin**, Jelena, Roger, Pau, Bjarne, Ole, Jan, Roel) [Wednesday]
  - **Jk & LSMIX:** (Jelena, **Mats**, Ole, Pau, Maria, Martin) [Wednesday]
     - Present: Xiaohua, Jelana, Ole, Martin, Mats and Carlos 
     - Conclusion from the experiments that has been run on the CARRA-SW and CARRA-NE domains, comparing to the case with and without LSMIX, is that more experiments needs to be run inorder to see if coefficient tuning can make JK compete with LSMIX. Presently, LSMIX verifies better for pressure, while JK seems to verify as well for some other parameters. However, a large discrepency can be seen in the profiles for level around 800 - 500 hPa for JK. This points to that more investigation about the JK settings has to be performed. Furthermore, other seasons needs to be investiged as well. At this point JK remains an interesting and promising research topic, but can not act as a substitute for LSMIX.
     - Pau has pointed out in his presentation the importance of applying LSMIX to Q (Specific Humidity). Doing so there is either a drastical reduction of bias in humidity fields and also an improvement of Temperature and Wind scores in the vertical. The hypothesis is that mixing also Q is more consistent since we are mixing "the full" IFS state with HARMONIE first guess.
  - **Nowcasting:** (**Xiaohua**, Roger, Magnus, Jan, Jana, Martin, Mats, Carlos, Isabel, Roohollah) [Thursday morning][[BR]]
    **Targeted applications**[[BR]]
     - Small spatial and time scale features: Summer convection (Denmark, Spain Malloca+Tenerif). Fire risk (Portugal)[[BR]]
     - Energy production (wind + radiation fluxes): KNMI+met.no+SMHI (Norwind project) [[BR]]
     - General aviation purpose   [[BR]]
   **Assimilation algorithm & system**[[BR]]
     - hourly 4DVAR with 2h window [[BR]]
     - sub-hourly 750m 3DVAR/4DVAR. AROME coupling[[BR]]
     - EPS including members connected to real time radar advection[[BR]]
     - latent heat nudging of radar derived precipitation rate[[BR]]
     - variational constraints (Carlos).[[BR]]
   **Assimilated obs**[[BR]]
     - radar reflectivity, radial wind, mode-s, GPS, crowdsource [[BR]]
     - wind turbine height data (KNMI: continuous wind/humidity at 80 m, 6 stations, met.no)[[BR]]
     - AEMET wind measurement from high speed train[[BR]]
     - pseudo precipitation rate obs from radar advection[[BR]]
   **Discussions**[[BR]]
   Main intended nowcasting are on resolution of 2.5km or 750 m, with forecast length of 6 to 12h, a RUC with 15 min to 1h. 3DVAR, 4DVAR are main approaches. Option to use nudging for short range considered. Adaptation of algorithm/system according to practical needs seems necessary. At current stage, it maybe too early to use sub-km model for general forecast purpose.A number of research issues discussed:[[BR]]
     - Functionality with sub-hourly launch in 3DVAR/4DVAR needs development.[[BR]]
     - Options in internal AROME coupling and coupling with LBC needs deeper look.[[BR]] 
     - Large extension zone in 3DVAR/4DVAR necessary especailly for small domains need to consider obs data correction for high density observation important to do time lagged verification to take into account delivery time.[[BR]]
  - **Future of monitor, HARP:** MTEN, FSOI, DFS, Obsmon (Eoin, Roger, **Susanna**, Paulo) [Wednesday][[BR]]
  - **Ensemble generation:** (Jelena, **Pau**, Jan, Nils, Roger, Ole, Roel, Carlos) [Wednesday afternoon] LETKF, BRAND, EDA, forcing perturbation
     - Jelena points out the importance of making converge different data assimilation algorithms from the configuration point of view in HARMONIE. Pau and Jelena have set up a LETKF/4DVAR hybrid formulation that it is now running in test mode in a Jelena's experiment.
     - A very interesting discussion about computation of analysis perturbations using the Hessian of the Cost Function, which is the inverse of the Analysis Error Covariance Matrix. Jan has mentioned that he can try to compute analysis perturbations using this method with HARMONIE 3DVAR. It seems this method is quite expensive so maybe using 3DVAR is affordable
     - Work in finding a proper HYBRID formulation in HARMONIE is going on. So far there are several methods for HYBRID formulation based in 3DVAR, EDA, LETKF, BRAND... Evaluation/Verification of HYBRID is needed.
     - The method for modelling flow-dependency by means of Gaussian Integrals was also briefly discussed and it seems to have also applications in ensemble-based DA. Carlos will work further on this topic.
  - **Initialisation:** IAU, VC, FA (**Carlos**, Jelena, Pau, Roger) [Wednesday]
  - **Surface analysis & coupling with UA:** (Magnus, Roger, Pau, Jelena, Eoin, Carlos, **Sigurdur**) [Wednesday afternoon]
  - **SAPP:** (**Rónán**, Manuel, Bjarne, Roel, Eoin, Paulo, Isabel) [Tuesday]
      - Report [raw-attachment:SAPP_plans.pdf here]
  - **set up of common reference system:** (Roger, Jan, Eoin)


  -- [https://docs.google.com/spreadsheets/d/1SlkFt-I1YOwfZ955FeuJ89REkt3ji4IywE9UshCCwsI/edit#gid=1687001628 The HIRLAM-ALADIN rolling work plan for 2019:][[BR]]


