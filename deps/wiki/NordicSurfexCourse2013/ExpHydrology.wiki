[[PageOutline]]
[[Center(begin)]]
= ''' Exercise: Hydrological applications ''' =
[[Center(end)]]

''' Responsible experts: David Gustafsson and Eric Martin '''
----------------------
The exercice is based on a 1500 km2 basin in Southwest of France [https://maps.google.fr/maps?q=Lagu%C3%A9pie&hl=fr&ie=UTF8&ll=44.111254,2.373047&spn=2.25196,5.767822&sll=43.30543,1.244992&sspn=2.282443,5.767822&oq=Laguepie&hnear=Lagu%C3%A9pie,+Tarn-et-Garonne,+Midi-Pyr%C3%A9n%C3%A9es&t=h&z=8 The Aveyron at Laguepie ]. [[BR]]
Forcing data are extracted from the SAFRAN analysis system. Results are compared to the observed discharge. [[BR]]

The observed discharge is compared to the Surfex runoff : surface runoff (RUNOFF) + botton runoff (DRAIN). As the basin is small and observations are at a daily time step data ISBA runoff is directly compared to discharge (no hydrological model for routing). Even if only one point is simulated, the namelist makes use of the standard databases and simulated one grid point of 8x8 km, as for spatialized hydrological applications.

----------------------
set up of the exercice :

Forcing data :  [https://hirlam.org/trac/attachment/wiki/NordicSurfexCourse2013/ExpHydrology/forcing_aveyron.tar.gz forcing_aveyron] 

Observations : [https://hirlam.org/trac/attachment/wiki/NordicSurfexCourse2013/ExpHydrology/O5292510.obs Aveyron_at_Laguepie]

Physiography : get the data from [http://www.cnrm.meteo.fr/surfex-lab/spip.php?rubrique14 surfex-lab] or use the link.sh procedure proposed : [[BR]]
1) Land use : Download ECOCLIMAP_II_EUROP.hdr.gz and ECOCLIMAP_II_EUROP_V2.1.dir.gz, gunzip the files and rename the first file into ECOCLIMAP_II_EUROP_V2.1.hdr. [[BR]]
2) Topography : Download gtopo30.hdr.gz and gtopo30.dir.gz, gunzip the files. [[BR]]
3) Soil texture : Download CLAY_HWSD_MOY.hdr.gz CLAY_HWSD_MOY_v2.dir.gz SAND_HWSD_MOY.hdr.gz SAND_HWSD_MOY_v2.dir.gz gunzip the files and [[BR]]
renanme CLAY_HWSD_MOY_v2.dir into CLAY_HWSD_MOY.dir and SAND_HWSD_MOY_v2.dir into SAND_HWSD_MOY.dir[[BR]]
4) top model global 1k soil index (hydro1k) (topography section) topo_index.hdr.gz and topo_index.dir.gz if you want to test the topmodel subgrid runoff

OPTIONS.nam : 2 examples are provided :[[BR]]
[https://hirlam.org/trac/attachment/wiki/NordicSurfexCourse2013/ExpHydrology/OPTIONS.nam_3-L_BASIC OPTIONS.nam_3-L_BASIC] : 3-L version with no subgrid options[[BR]]
[https://hirlam.org/trac/attachment/wiki/NordicSurfexCourse2013/ExpHydrology/OPTIONS.nam_DIF OPTIONS.nam_DIF] : moreless the namelist of the future SIM version.[[BR]]


Now you can run pgd, prep and offline. [[BR]]

For plots and comparisons :[[BR]]
use [https://hirlam.org/trac/attachment/wiki/NordicSurfexCourse2013/ExpHydrology/discharge.py discharge.py] to plot results and observations in the run directory[[BR]]
use [https://hirlam.org/trac/attachment/wiki/NordicSurfexCourse2013/ExpHydrology/compare_discharge.py compare_discharge.py] to plot models results that are stored in separate directories.


Suggestions are to run the basic options, compare with the observations, then add subgrid hydrology options and to look at the progress !

Try :[[BR]]
subgrid runoff DT92 (VIC) with various RUNOFFB (around 0.5)[[BR]]
exponential profile of KSAT (CEXP='SGH')[[BR]]
add a subgrid drainage (XUNIF_WDRAIN= 0.001 or other values)[[BR]]
change the number of patches from 1 to 12[[BR]]


In addtion:[[BR]]
If you want to test the topmodel-based subgrid runoff (CRUNOFF='SGH'), you need to increase the size of the grid cell (XDX and XDY in NAM_IGN, change from 8000m to 100000m) as this options is activated at large grids.

You can alos try to use the multilayer model DIF (second namelist)

Documentation : [[BR]]
1) see the [https://hirlam.org/trac/attachment/wiki/NordicSurfexCourse2013/Programme/2013_nordic_surfex_hydrology_options.pdf course] [[BR]]
2) documentation of [http://www.cnrm.meteo.fr/surfex-lab/spip.php?article60 NAM_ISBA] in surfex-lab (RUNOFFB, WDRAIN)[[BR]]
3) documentation of [http://www.cnrm.meteo.fr/surfex-lab/spip.php?article83 NAM_SGH_ISBA] in surfex-lab[ (other options) [BR]]

