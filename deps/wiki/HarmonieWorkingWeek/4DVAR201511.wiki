[[PageOutline]]
[[Center(begin)]]
= '''HARMONIE Working Days on code development and HARMONIE AROME 4DVAR 2015''' =
''ECMWF, Reading, 23^th^ of November - 27^th^ of November 2015''[[BR]]
Last modified [[LastModified]]
[[Center(end)]]

The autumn HARMONIE Working Days of code development and HARMONIE AROME 4DVAR 2015 will be hold this year in Reading, on the premisses of the ECMWF, during week 48, Monday - Thursday, the 23rd of November - the 26th of November. The topic of the Working Days is the integration of the HIRLAM algorithmic developments into the IFS modelling environment. The development of the meso-scale data assimilation system is one of the strategical priorities of the HIRLAM consortium. The HARMONIE AROME 4DVAR is the HIRLAM baseline development for data assimilation on convection-permitting scale. A number of alternative algorithms for flow-dependent data assimilation are considered. The ECMWF has kindly agreed to extend the HARMONIE Working Days with one day of the collective discussion on joint code development with the ECMWF and LAM partners involved.  

= Participants =
||= Name                    =||= Arrival-Departure =||= Institute =||= Hotel    =||
||Jelena Bojarova            || 23.11 - 27.11       || SMHI        || Ibis Hotel ||
||Nils Gustafsson            || 23.11 - 26.11       || SMHI        || Ibis Hotel ||  
||Magnus Lindskog            || 23.11 - 26.11       || SMHI        ||            ||
||Martin Ridal               || 23.11 - 26.11       || SMHI        ||            ||
||Xiaohua Yang               || 23.11 1400 - 27.11 1600 || DMI         || Hillindon Prince Hotel ||
|| Jan Barkmeijer            || 24.11 - 27.11       || KNMI        ||            ||
|| Roel Stappers             || 23.11 - 27.11       || MET Norway  ||            ||
|| Roger Randriamampianina   || 24.11 - 27.11       || MET Norway  ||            ||
|| Eoin Whelan               || 26.11 - 27.11       || METIE       || Ibis Hotel ||
|| Mate Mile                 || 25.11 - 27.11       || OMSZ        ||            ||


= Aim of the Working Week =

 The main objective of the HARMONIE Working Days is further development of HARMONIE AROME 4DVAR : assure stable technical performance, evaluate of meteorological performance of the HARMONIE AROME 4DVAR and continue implementation of high-resolution observations (radar data, GNSS, Mode-S) HARMONIE AROME 4DVAR. 

 The integration of the HIRLAM algorithmic developments into the common codes is an additional topic of the HARMONIE Working Days. The HIRLAM and ALADIN consortia are developing scientific codes jointly within the common IFS code environment. This requires maintenance and coordination of a very complex system what creates a challenging situation for all partners involved. Several algorithmic developments are of high interest for several partners (4DVAR, (L)ETKF, Hybrid, VarBC), and development of these algorithms should be done in a coordinated way. The IFS modelling environment undergoes a deep overhaul and restructuring of the codes to guarantee that the software infrastructure remains competitive and powerful on future computer architectures. We see the OOPS as a software infrastructure for future NWP and integration of new developments into the OOPS system is an important issue for us. On our side we have to assure that HIRLAM algorithmic developments are  carried out in  compliance with the OOPS-imposed IFS/Fortan code refactoring, and that proposed OOPS design supports all needed functionalities. 

 The procedure/guidelines on how to introduce new data assimilation algorithms (and extend functionalities) into the existing system OOPS are needed, and we propose this topic for the collective discussion on Friday, the 27th of November. Amother question to be addressed is a possible contribution from the HIRLAM side to the OOPS imposed IFS Fortran code re-factoring.  The current practise of contribution from the HIRLAM side is not very efficient. It leads to multiple re-implementations of the developments in the changing code environment. This complicates a lot our possibility to contribute meaningfully to the scientific development of the codes and in addition weakens motivation for our team. We are interested to discuss (and to plan eventually) possible  HIRLAM contribution to the IFS Fortran code refactoring on the tasks which is in line with our code developments (more flexible VarBC, additional optimization constraints, TL/AD models in relation to AROME 4DVAR, projection to the observation space and (L)ETKF) and possibility to implement our scientific developments on the latest code releases.

= IFS Fortran code refactoring =

 The test environment for observation operator refactoring was developed at ECMWF (Alan Geer). The test harness, HOP_DRIVER, calls the observation operator and generates FG departures without calling any model code or initialising any model modules. Firstly, the IFS is used to dump a single-observation GOM_PLUS to file from the 1st trajectory of an experiment. Dumping multiple observations would require a more complex and full-featured dump (good file format, multi-process parallel). For code refactoring HOP_DRIVER can be used to test changes to the observation operator of a particular observation type. Local implementation of the HOP_DRIVER environment in Harmonie (based on CY42R2: https://hirlam.org/trac/browser/branches/refactor/harmonie) and the documentation ([wiki:HarmonieSystemDocumentation/ObservationOperators HOP_DRIVER Test Environment]) is provided by Eoin Whelan. The example with the  AMSU-A (HOPOBS=amsua) single observation experiment is available for testing with HOP_DRIVER. 

= 4DVAR Verification sites =

[https://hirlam.org/portal/validation/38h1/DNICAST_201304/ 3DVAR versus 4DVAR over Iberian domain (DNICAST) by SMHI ]
 (conventional + AMSU-A, AMSU-B, MHS). CY38h1.2, can also be found in http://metcoop.met.no/verif/DNICAST_201304_export/

High-resolution Observations Impact Studies Experiments (by KNMI)
 Conventional + Mode-S

https://hirlam.org/portal/validation/38h1/IMPACT1/

Inter-comparison of  physics schemes (HARATU scheme : MP_NWSWITCH )

https://hirlam.org/portal/validation/38h1/IMPACT2/


= Preliminary Agenda =

 == Monday the 23rd November - Wednesday the 25th November : HARMONIE AROME 4DVAR and high resolution observations == 
  - Status of HARMONIE AROME 4DVAR [https://hirlam.org/trac/raw-attachment/wiki/HarmonieWorkingWeek/4DVAR201511/magnus_4dvar_ec.pdf pdf]  
  - Tasks to be addressed 
     - High-resolution observations in the HARMONIE AROME 4DVAR  
      * Radar data  (both radar data and reflectivities : check for technically feasible performance)
      * ZTD GNSS (start implementation in the 4DVAR context)
      * Mode-S data (tuning of the observation network for optimal performance)
     - Configuration
      * TL and AD propagation of moist increment
      * change of resolution
      * assimilation window/update frequency
     - Technical stability
      * ECMA/CCMA updates 
      * observation operators in 4DVAR context using evolved surface fields
     - Meteorological performance 
      * Jc-DFI
     - Code evolution and compliance with IFS Fortran code re-factoring 
      * AROME 4DVAR trajectory run and observation operators in CY43 (code analysis) 
      
  == Thursday, the 26th of November : DA code algorithmic developments in common IFS modelling environment
   - Topics for discussion 
    * VarBC
    * (L)ETKF [https://hirlam.org/trac/raw-attachment/wiki/HarmonieWorkingWeek/4DVAR201511/Status_LETKF_HARMONIE_Sept2015.ppt ppt] 
    * Extension of control vector space, hybrid formulations and alpha control variable  [https://hirlam.org/trac/raw-attachment/wiki/HarmonieWorkingWeek/4DVAR201511/HIGHRES_HYBRIDGAIN_EDA_500_Z_NHEM_AC.pdf pdf] 
    * Unified variational data assimilation framework for meso-scale DA and HIRLAM contribution for common code evolution  [https://hirlam.org/trac/raw-attachment/wiki/HarmonieWorkingWeek/4DVAR201511/UVF.pdf pdf]
    * Matrix Free Linear Algebra (MFLA) [https://hirlam.org/trac/raw-attachment/wiki/HarmonieWorkingWeek/4DVAR201511/mfla.pdf pdf]
    * HOP_DRIVER test environment and generation of test input data
    * LAM OOPS 3DVAR prototype
    * OOPS as future software infrastructure and joint development of it 
  == Coordination : LACE plans on DA activities in 2016 and contact people  [https://hirlam.org/trac/raw-attachment/wiki/HarmonieWorkingWeek/4DVAR201511/lace_plan2016.pdf pdf]
  == Friday, the 27th of November : collective discussion on coordination of common code developments between ECMWF and LAM partners

     - 9:15 -  9:30 Geometry and Model objects, SPAM (Tomas + Olivier)
     - 9:30 -  9:45 Trajectory handling (Olivier)
     - 9:45 - 10:00 Jb, background and first guess (Mike)

    Coffee

     - 10:30 - 10:45 GOM and HOP interface (Alan)
     - 10:45 - 11:00 HOP TL+AD and test programs at Meteo-France (Claude)
     - 11:00 - 11:15 ODB interface (Peter)

     - 11:15 - 11:30 Upcoming IFS cycles (Deborah)
     - 11:30 - 11:45 C++ interfaces and unit tests (Yannick)
     - 11:45 - 12:00 General questions

= Report from the HARMONIE Working Days on code development and AROME 4DVAR  [https://hirlam.org/trac/raw-attachment/wiki/HarmonieWorkingWeek/4DVAR201511/report_4DVAR.pdf pdf]

= Additional information =
   * HIRLAM algorithmic developments [https://hirlam.org/trac/raw-attachment/wiki/HarmonieWorkingWeek/4DVAR201511/OOPS_note.pdf pdf]
   * LAM OOPS 3DVAR prototype modifications on top of CY40_main [https://hirlam.org/trac/raw-attachment/wiki/HarmonieWorkingWeek/4DVAR201511/oops_lam_3dvar.tar tar]
   * OOPS LAM 3DVAR installation at HMS [https://hirlam.org/trac/raw-attachment/wiki/HarmonieWorkingWeek/4DVAR201511/oops_proto_installation_at_hms.pdf pdf]
   * Implementation of the ETKF rescaling scheme in OOPS framework [https://hirlam.org/trac/raw-attachment/wiki/HarmonieWorkingWeek/4DVAR201511/ETKF_implementation.pdf pdf]

= Accommodation =

 Here please find the list of hotels suggested on the ECMWF website

 http://www.ecmwf.int/en/about/contact-us/location

== Reference: previous HARMONIE DA/UO working weeks ==
* [wiki:HarmonieWorkingWeek/UseObs201509 201509], Dublin, The Harmonie DA&UO Working Week 2015
* [wiki:HarmonieWorkingWeek/4DVAR201503 201503], Norrk√∏ping, The Harmonie 4DVAR Working Week 2015
* [wiki:HarmonieWorkingWeek/UseObs201410 201410], Santander, The Harmonie DA&UO Working Week 2014
* [wiki:OOPS/KNMI_201409 201409], KNMI, The HARMONIE OOPS/C++ Working Meeting
