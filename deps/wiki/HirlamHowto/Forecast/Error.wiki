[[PageOutline]]

[[Center(begin)]]
== '''Hirlam HOWTOs''' ==
= '''Diagnosis of Typical Runtime Errors in Forecast Model ''' =
[[Center(end)]]

== How to handle with crash due to "exceeded CPU time" ==

Under mini-SMS environment, a crash may happen after a forecast job has consumed all of its allocated computation time with the message
{{{
Exceeded CPU time
}}}
It may even not have the opportunity to report back to mini-SMS that it failed, in which case mini-SMS will keep the job in status `active'. If you think this has happened to your job, adjust the job, or increase the requested resources, and re-queue the job. 

Although the overrunning of allocations can happen to any job, the forecast model is particularly susceptive to this, because it consumes so many resources (and also because it may get dead-locked if you did not get the parallellisation right...). 

To help monitoring the progress of jobs with mini-SMS, try to place limits on resources in such a way that if the forecast model fails because it runs out of allocation, it still has some resources left to communicate its failure back to mini-SMS. For example, if you use qsub, try to use -lT to limit total allocation, and -lt to limit the allocation for the forcast model itself. If the -lt limit is slightly smaller than the -lT limit, the job will have some resources left after the forecast model hit the -lt limit, to send information about its failure back to mini-SMS. An example for a job requiring 7900 seconds of CP time could be: -lT 8000 -lt 7900. 

== How to interpret the error "orography not found " ==

The message 
{{{
OROGRAPHY NOT FOUND - ABORT
}}}
usually means that an attempt to read an input file (analysis, or lateral boundary conditions) failed. The message may mean that the file was corrupt, but most likely it means that the file did not exist at all. Then the next paragraph applies. But if the file existed it must have been corrupt, and then it should be recreated, by rerunning the analysis, or one of the families for lateral boundary conditions (named: LBCn), as appropriate. 

If an input file is missing, diagnosed e.g. by one of the following: 
{{{
../yyyymmdd_hh/namrunProg: No such file or directory 
}}}
then this may find its cause in a disk cleaning procedure, or a disk crash, between the moment that the file was created and the moment that the file was needed. This problem may occur both for the file itself, as for possibly required symbolic links related to the file. The solution is to recreate the input files. Do this by re-queuing all tasks in family FCinput. Then the forecast model can be re-queued as well. It is probably not adequate to simply restart mini-SMS in resume mode, because the FCinput family will be deemed to be complete, so it will not be rerun. 

== What does the error message "nprocy*nprocx # nproc" mean ==

A message of the type 
{{{
nprocy*nprocx # nproc:  nx * ny # n
}}}
is generated if the number of processors requested (n) is not equal to the product of the deemed number of processors in the x and y direction, resp. The following paragraphs describe where the (two) deemed and the (one) requested number of processors are determined. Do the necessary adjustments to make the three numbers consistent. 

The two deemed numbers of processors are read from the namelist, which is generated by the Execute task of the mini-SMS family FCinput. This script reads those numbers from the 'ENVIRONMENT' file which, in its turn, is constructed from the script Env_qsub. 

The way that the requested number of processors is specified depends on the operating system and the parallellisation paradigm. Under NQS, the number of processors is given on the qsub command line (e.g. with the -lP option). On some systems it may have to be passed on the command line (e.g. with the -n option of the mpprun command on T3E). Be aware that the number of processors thus specified should be equal to the product of the number of processors in the x and y direction '''plus''' the number of processors assigned to asynchronous IO (specifies in environment variable NPROC_HGS):
{{{
specified_number_of_processors = NPROCX * NPROCY + NPROC_HGS
}}}
The universal job submission procedure implemented in HIRLAM under mini-SMS knows about this arithmetic in the script submission.db. So usually the above error message is the consequence of an error in script submission.db.

== How to deal with error related to too small HALO zone ==

A message of the type
{{{
TRUNCATION IN HALO ZONE IN BIXINT
}}}
is issued if the length of a trajectory in the semi-Lagrangian advection scheme exceeds the width of the halo zone. The halo zone consists of the row of grid points of which the field values are exchanged between neighbouring processors at every time step. This exchange is organised by MPI. So this error can only occur on parallel implementations, not using shared memory. 
The cure consists of decreasing the time step NDTIME or increase number of grid points in HALO zone GPHALO, both in script Env_expdesc. 

== How to interpret error messages about GRIBEX == 

The message: 
{{{
GRIBEX : End of message 7777 group not found. Return code = 805
ABORTX : Routine GRIBEX has requested program termination.
}}}

indicates that one of the input files was corrupt. Try to figure out which one (analysis, lateral boundary conditions) from the progress of the forecast model until this error was reported and recreate the offending file (see above). 


[[SubWiki]]

[[Center(begin)]]
[https://hirlam.org/trac/wiki/HirlamHowto Back to the main page of the HIRLAM-HOWTO]
[[Center(end)]]
----
[[Center(begin)]]
[[Disclaimer]]

[[Color(red, Last modified on)]] [[LastModified]]
[[Center(end)]]