[[PageOutline]]
[[Center(begin)]]
= '''Greenhouse gases in HCLIM''' =
[[LastModified]]
[[Center(end)]]

== Implementation in HCLIM ==
HCLIM uses 6 green house gases (GHG): CO2, CH4, N2O, CFC11, CFC12 and N2O. In the default setup, the GHG concentrations are updated at every radiation time step by routine updrgas. In this routine annual, global mean concentrations are given for CO2, CH4, N2O, CFC11, CFC12. For NO2 a fixed concentration is set. For the historical period (here 1850-2000) there is one set of concentrations from SRES, based on observations. These values are stored in variable ZHVAR. The future concentrations (2000-2100) are stored in ZFVAR.
There are at the moment 4 future scenarios, which can be selected with the NSCEN variable:
1. SRES A1B
2. SRES A2
3. SRES B1
4. CMIP5 his (<=2005) and RCP8.5 (>= 2006), implemented in [17992] by David

Note that up to 2000 always the SRES historical values are used, even with NSCEN=4. As of [17992] NSCEN 4 is set as the default suecrad, before that it was 1. It should be possible to set NSCEN via the naerad namelist (untested).
In updrgas it is assumed concentrations for a year are valid for the middle of the year and are calculated in such a way they are constant for a month.

The concentrations for SRES A1B and CMIP5 RCP8.5 are shown in the graph below. It can be seen that for the historical parts the SRES and CMIP5 concentrations are very comparable, apart from CFC11. For CFC11 observed values on https://www.esrl.noaa.gov/gmd/hats/combined/CFC11.html are closer to CMIP5 than to SRES.

=== Reading from external files ===
If LGHGCMIP5 is set to true the ZHVAR and ZFVAR arrays from updrgas are overwritten in read_cmip5ghg with values read from text files. Unfortunately, the format of those text files expected by read_cmip5ghg does not match the format of the text files we currently have in the climate/RCP directory (RCP85_MIDYR_CONC.dat). So either the text files we have should be preprocessed, or the reading of the files should be adapted. The NRCP variable is then used to control which CMIP5 scenario is used. 

== Some relevant variables == 
||variable ||default ||comment ||
||LHGHG    ||T       ||LOGICAL : .T. IF VARIABILITY OF GREENHOUSE GASES (INCLUDING CO2) IS ON; N.B.: LHGHG supercedes LECO2VAR and allows using better specification of trace gases ||
||LECO2VAR ||F       ||LOGICAL: .T. IF ERA-40/AMIP2 VARIABILITY OF GHG IS ON ||
||LGHGCMIP5||F       ||LOGICAL: read GHG concentrations from text files ||
||NSCEN    ||4 (1 before[17992]) ||INTEGER : 21st CENTURY SCENARIO FOR GHG (1=A1B, 2=A2, 3=B1, 4=RCP8.5) ||
||NRCP     ||1       ||INTEGER : 21st CENTURY RCP FOR CMIP5 (1=RCP 3-PD, 2=RCP 4.5, 3=RCP 6.0, 4=RCP 8.5) ||
||NRADFR   ||900/TSTEP ||INTEGER : FREQUENCY OF FULL RADIATION COMPUTATIONS ||
\\
[[Image(GHG_in_HCLIM38h1_A1B_vs_RCP8.5.png)]]