[[PageOutline]]
[[Center(begin)]]
== '''HARMONIE 38h1''' ==
 ''The Guinness release''
[[Center(end)]]


== Description of Harmonie 38h1 ==

Harmonie 38h1 is HIRLAM's adaptation to the IFS/ARPEGE CY38T1 released in August 2012 and the subsequent bugfix versions 1 to 3. 

At its default, Harmonie-38h1 comprises the following features:

 * A meso-scale NWP forecast system with convection-permitting AROME physics and non-hydrostatic dynamics on a model grid with 2.5 km grid-spacing in horizontal and 65 vertical levels.
 * Treatment of surface processes by SURFEX
 * 3D-VAR upper air assimilation with 3h cycling
 * Optimal interpolation-based surface analysis using CANARI for the spatialization and SODA for the update of surface variables.
 * A comprehensive set of utilities for observation preprocessing, model diagnostics, monitoring and verification.
 * A scheduler, mSMS, and a graphical interface, mXCdp, for running an controlling the full suite.

== News in Harmonie-38h1 ==

=== Major changes ===

The major changes in cy38h1.beta.3 compared to cy37h1.2 are:

 * Physics
  * SURFEX 7.2, for documentation of SURFEX versions see the [http://www.cnrm.meteo.fr/surfex-lab/spip.php?rubrique12 SURFEX webpage]
  * Improved statistical cloud scheme
  * Use different cloud droplet number concentration depending on land/sea/town
  * ALARO physics updates

 * Assimilation
  * 3h cycling
  * RTTOV V10
  * Assimilation of ATOVS (still turned off by default)

 * Technical
  * Surfex output as FA files for improved scalability
  * Call of SODA from inside of CANARI
  * Optional IO-server for improved scalability
  * Externalization of RTTOV coefficient files
  * Various performance improvements
 
 * Verification
  * New skill scores introduced
  * Allow verification of different initial times
  * Allow verification for forecasts valid at the same time

 * Diagnostics and postprocessing
   * Fully integrated inline postprocessing
   * Extended list of postprocessing variables
     * [wiki:HarmonieSystemDocumentation/Forecast/Outputlist/38h1]

 * HarmonEPS
   * Several technical updates for better performance.

 * Climate simulation mode (experimental)

=== Changes between CY37T1 and CY38T1 ===

The changes in the common IFS/ARPEGE code are documented in the following documents.

  * [https://hirlam.org/trac/attachment/wiki/Harmonie_38h1/cy37t1.pdf CY37T1 memorandum] for reference
  * [https://hirlam.org/trac/attachment/wiki/Harmonie_38h1/cy38.pdf CY38 memorandum] A common cycle between ECMWF and Meteo France.
  * [https://hirlam.org/trac/attachment/wiki/Harmonie_38h1/cy38t1.pdf CT38T1 memorandum] 
   * [https://hirlam.org/trac/attachment/wiki/Harmonie_38h1/cy38t1_bf.01.txt CY38T1 bugfix 1]
   * [https://hirlam.org/trac/attachment/wiki/Harmonie_38h1/cy38t1_bf.02.txt CY38T1 bugfix 2]
   * [https://hirlam.org/trac/attachment/wiki/Harmonie_38h1/cy38t1_bf.03.txt CY38T1 bugfix 3]

=== Changes between harmonie-38h1.beta.2 and harmonie-38h1.beta.3 ===

 Read more about the release notes of harmonie-38h1.beta2 [wiki:ReleaseNotes/harmonie-38h1.beta.2 here]
 The main differences between beta.2 and beta.3 are summarized in the list below. For a full list of changes please look at the [https://hirlam.org/trac/log/trunk/harmonie/?action=stop_on_copy&mode=stop_on_copy&rev=12418&stop_rev=12139&limit=500 change log].

 * Implementation of the ability to call SODA from inside of CANARI. This is accompanied by the removal of nested OpenMP directives degrading the perfomance of the forecast model.
 * Enable EKF experimentation with SODA, testbed case AROME_EKF.
 * Fix for running BE04 option in SURFEX.
 * Update to grib_api.1.10.4, gribex 370, bufr 383.
 * Fixes to make radar assimilation running.
 * Set ECOCLIMAP II as default and tuning in SURFEX settings, [12406].
 * Easier output of 2D diagnostics fields [12371]
 * Improved initialisation for the initial surfex state.
 * Separate evaluation of liquid/sold microphysics, switched off, experimental
 * A number of smaller bug fixes and improvements in the diagnostics, scripts and verification environment

=== Difference between CY38T1 and harmonie-38h1 ===

 harmonie-cy38h1 contains a number of developments not introduced in or done after the release of CY38T1. The difference between harmonie-38h1.beta.3 and CY38T1_bf.03 can be summarized as:

 * Satellite BUFR file decoding in Bator and treatment of empty pools
 * ATOVS blacklisting and VARBC predictor treatment
 * IO-server changes, IO optimization ( some backporting from CY39T1)
 * SURFEX FA format file manipulation tools. ( backporting from CY39T1 )
 * Ability to run SODA inline CANARI
 * Use different cloud droplet number concentration depending on land/sea/town for cloud sedimentation
 * Added OpenMP directives in SURFEX related parts
 * Changed weights between land/sea for T2M diagnostics
 * Snow analysis changes
 * Update of SURFEX SST from the boundary files, for climate simulations
 * Fix for running BE04 option in SURFEX.
 * Easier output of 2D diagnostics fields [12371]
 * Improved initialisation for the initial surfex state.
 * Separate evaluation of liquid/sold microphysics, switched off, experimental

The full list of changes can be found in the following [https://hirlam.org/trac/attachment/wiki/Harmonie_38h1/svndiff_all_cy38h1.beta.3.txt document]. Some of the differences have already been introduced in [wiki:Phasing/cy39t1 CY39T1] and others will be part of the HIRLAM contribution to CY40T1.

=== Tested configurations ===

The following configurations have been tested and are working technically at ECMWF and several linux clusters.

 * AROME_3DVAR: AROME physics with surface assimilation and 3DVAR, the default configuration
 * AROME: AROME physics with surface assimilation and upper air blending 
 * AROME_MUSC: Single column model (MUSC) with AROME physics
 * ALARO_3DVAR_OLD: ALARO physics and old ISBA with surface assimilation and 3DVAR
 * ALARO_OLD: ALARO physics and old ISBA with surface assimilation and upper air blending
 * AROME_CLIMSIM: Climate simulation with AROME physics
 * AROME_EPS: HarmonEPS setup 
 * AROME_EKF: AROME with SODA+EKF
 * AROME_3DVAR_FA_IO_SERVER: As AROME_3DVAR but with the IO-server activated

Configurations available in harmonie-37h1.2 that are still not working are

 * ALARO: ALARO + SURFEX
 * AROME_BD_ARO: Running AROME driven by boundaries from AROME


=== Releases ===

The following versions of harmonie-38h1 have been released

 * Third version for meteorological evaluation [browser:tags/harmonie-38h1.beta.3 harmonie-38h1.beta.3], tagged on October 18th 2013
 * Second version for meteorological evaluation [browser:tags/harmonie-38h1.beta.2 harmonie-38h1.beta.2], tagged on July 25th 2013
 * First version for meteorological evaluation [browser:tags/harmonie-38h1.beta.1 harmonie-38h1.beta.1], tagged on May 1st 2013
 * Second technical version [browser:tags/harmonie-38h1.alpha.2 harmonie-38h1.alpha.2] tagged on Mar 12th 2013
 * First technical version [browser:tags/harmonie-38h1.alpha.1 harmonie-38h1.alpha.1], tagged on Jan 24th 2013


== Harmonie-38h1 downloads ==

 * On ECMWF, the check-out version of harmonie-38h1.beta.3 is available as,
{{{
   ecgate:/home/ms/spsehlam/hlam/harmonie_release/tags/harmonie-38h1.beta.3
}}}
 * Via Subversion:
{{{
   svn co https://svn.hirlam.org/tags/harmonie-38h1.beta.3
}}}

 * The testbed data set including boundaries, observations, climate files and background statistics for assimilation can be downloaded [https://hirlam.org/portal/download/testbed/38h1/38h1.tar here]. Read more about the testbed [wiki:HarmonieSystemDocumentation/Evaluation/HarmonieTestbed here].

 * Climate data for cy38h1 can be found under [https://hirlam.org/portal/download/harmonie_climate/38h1.tar.gz] or on c2a under {{{/project/hirlam/harmonie/climate/cy38h1}}}.
 * RTTOV constants for cy38h1 can be found under [https://hirlam.org/portal/download/sat_const/sat_const_cy38h1.tar.gz] or on c2a under {{{/project/hirlam/harmonie/sat_const/cy38h1}}}.

== Model Installation and Experiment Configuration ==

Users are referred to the system wiki documentation about [wiki:HarmonieSystemDocumentation/Installation Information and Instruction on basic system installation and experiment configuration] and to the [https://hirlam.org/trac/wiki/HarmonieSystemDocumentation/Harmonie-mSMS Harmonie-mSMS configuration documentation] for running an experiment at ECMWF in particular and on your local platform in general.

The version is available on ecgate as:

{{{
~hlam/harmonie_release/tags/harmonie-38h1.beta.3/config-sh/Harmonie setup
}}}

== Meteorological performance of Harmonie-38h1 ==

The meteorological status and validation of the Harmonie-38h1 performance can be seen [wiki:Harmonie_38h1/ValidationTests here]

== Technical aspects of Harmonie-38h1 ==

=== Problems and bugfixes ===

There are still problems with cy38h1. For the latest status see [https://hirlam.org/trac/query?status=accepted&status=assigned&status=new&status=reopened&version=38h1&order=priority&report=11 ticket page].

== Acknowledgements ==

38h1-system is the result of collective development and implementation work of HIRLAM-B programme under the cooperation context of HARMONIE, with major scientific and technical contribution from partners in ECMWF, Meteo France and members of ALADIN consortia. We thank colleagues at our partner institutes for all the valuable contribution and assistance during the implementation of CY38T1.

Niko Sokka, FMI, is the responding system manager for 38h1-code series. Bjarne Andersen, Ulf Andrae, Trygve Aspelien, Lisa Bengtsson, Jelena Bojarova, Dag Björge, Javier Calvo, Mats Dahlbom, Per Dahlgren, Inger-Lise Frogner, Mariken Holmleid, Mariano Hortal, Karl-Ivar Ivarsson, Rimvydas Jasinskas, Martynas Kauzlaukas, Magnus Lindskog, Sami Niemela, Enda O'Brien, Roger Randriamampianina, Laura Rontu, Sander Tijm, Sami Saarinen, Niko Sokka, Ole Vignes, Villaume Sébastien, Eoin Whelan and Xiaohua Yang contributed in different ways through development, evaluation and testing.

----
[[Center(begin)]]
[[Color(red, Last modified on)]] [[LastModified]]
[[Center(end)]]''
