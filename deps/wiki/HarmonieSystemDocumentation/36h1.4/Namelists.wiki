[[PageOutline]]

[[Center(begin)]]
= '''Harmonie System Documentation''' =
== '''Controlling the namelists in HARMONIE''' ==
[[Center(end)]]

== Introduction ==

IFS is largely driven by namelists and has thousands of options. For each configuration a number of namelists controlling different parts are read. To make the maintenance of the namelists manageable and to assure consistency in terms on e.g. name conventions for fields, packing accuracy, physics settings and parallel options the namelists are generated at the initial stage of your experiment. All the basic settings are defined in a perl dictionary [source:tags/harmonie-36h1.4/nam/harmonie_namelists.pm harmone_namelists.pm]. The dictionary are structured in several sections:

* Global settings
* Technical settings
 * Host specific settings
 * MPP options
 * File settings

* DYNAMICS SETTINGS
 * Main dynamics switches
 * Non-hydrostatic settings
 * Vertical finite element
 * DFI

* Main physics options. NB! These may contain switches for dynamics as well
 * ALADIN
 * AROME
 * EDMFM switches, to be applied after AROME
 * Alaro
 * Old surface
 * SURFEX
 * DDH

* E927 Interpolation settings
 * Main fullpos settings
 * E927
 * E927 nh
 * SURFEX initial file generation
 * Aladin e927
 * ALARO e927
 * Arome e927

* General postprocessing switches 
 * Default fullpos settings
 * NH postprocessing
 * Switches for postprocessing with surfex
 * Special cases for arome

* Assimilation
 * Canari
  * Arome canari
 * Varbc_rad
 * Varbc_coldstart
 * Screening
  * Arome screening
  * Alaro screening
 * Minimization
   *Alaro minimization
 * 4DVAR 
   * 4DVAR minimization
   * 4DVAR screening
   * 4DVAR trajectory

* Climate generation
 * Climate generations (e923)

* Misc
 * General namelist settings for Tangent-Linear and Adjoint tests 
 * Extra Adjoint test options 
 * Oulan
 * Bator

The final namelists are build through the rules given in a [source:tags/harmonie-36h1.4/nam/Makefile Makefile] and are generated by [source:tags/harmonie-36h1.4/nam/gen_namelists.pl gen_namelists.pl]. The different parts of the dictionary are superimposed by the rules given in the Makefile, like for the generation of an inital SURFEX file.

{{{
namelist_e927_surfex : empty.pm harmonie_namelists.pm
        ./gen_namelist.pl global host_specific mpp file fullpos e927 $(E927_DYNAMICS) e927_surfex > $@
}}}

Note that for most cases environment variables not known at the time of the namelist generation are parsed in the scripts.

SURFEX namelists are not generated but are sitting in the [source:tags/harmonie-36h1.4/nam/ namelist directory] and/or built by the scripts.

== Change your namelists ==

There are two ways of changing namelists generated from the dictionary.

* Copy the harmonie_namelist.pm file to your local experiment directory and change the right section.

* If you feel uncertain where to change in the dictionary you can copy the generated namelist from $HM_LIB ( the copy of harmonie where the data are found ) put it under the {{{nam}}} directory in your local experiment. Make sure you give it a unique name. You must then also change the script(s) using this namelist like in the [source:tags/harmonie-36h1.4/scr/Forecast Forecast] script.

{{{

#  Get namelist name
#NAMELIST=$HM_LIB/nam/namelist_forecast
NAMELIST=$HM_LIB/nam/namelist_forecast_with_a_unique_name

}}}

For namelists not present in the dictionary you just copy them to you local {{{nam}}} directory.

There is also a description on how to generate new namelist dictionaries in 
[HarmonieSystemDocumentation/36h1.4/UpdateNamelists here].

[[Center(begin)]]
[wiki:HarmonieSystemDocumentation Back to the main page of the HARMONIE System Documentation]
[[Center(end)]]
----

[[Center(begin)]]
[[Disclaimer]]

[[Color(red, Last modified on)]] [[LastModified]]
[[Center(end)]]