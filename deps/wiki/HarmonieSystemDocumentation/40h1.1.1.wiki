[[PageOutline]]
[[Center(begin)]]
= '''Harmonie System Documentation''' =
[[Center(end)]]

== '''Overview''' ==
This page describes how to get started with harmonie-40h1.1.1. Documentation of previous releases is available here: [wiki:HarmonieSystemDocumentation/40h1.1/PreviousVersions previous versions]

A high level overview of HARMONIE, (system content, programs and file formats used), is available in the links below:
 * [wiki:HarmonieSystemDocumentation/40h1.1/Content Harmonie content]: Summary of the HARMONIE system and its content - schedulers, scripts and source code and auxiliary software tools
 * [wiki:HarmonieSystemDocumentation/40h1.1/Binaries Binaries in HARMONIE]: Summary of HARMONIE programs 
 * [wiki:HarmonieSystemDocumentation/40h1.1/FileFormats File formats]: Information on file formats used by HARMONIE, input and outputs, including FA, GRIB, BUFR and ODB

[wiki:HarmonieSystemDocumentation/40h1.1/TrainingCourses Training Courses] also provide a useful overview of the HARMONIE system and its components.
== '''Tutorial''' ==
This is a "placeholder" for a beginners tutorial (possibly supplemented with a !YouTube video?)
 * Tutorial to test Harmonie on your PC
 * Tutorial to test Harmonie at ECMWF
== '''Quick start''' ==
=== ECMWF ===
Below are links on how the start running HARMONIE at ECMWF. There is also information on how to speed up your compilation on cca and information on how to use the ''Harmonie'' script
 * [wiki:HarmonieSystemDocumentation/40h1.1/Harmonie-mSMS Running Harmonie at ECMWF]: A guide to running your first Harmonie experiment at ECMWF
  * [wiki:HarmonieSystemDocumentation/40h1.1/Fast_start_on_cca Faster compilation on cca]: Information on how to compile Harmonie code more quickly on ECMWF's HPC platform, cca
 * [wiki:HarmonieSystemDocumentation/40h1.1/TheHarmonieScript The Harmonie script]: The ''Harmonie'' script and how to use it
 * [wiki:HarmonieSystemDocumentation/40h1.1/ModelDomain Model domain]: How to define a new model domain for your first experiment
Have a look at the [wiki:HarmonieSystemDocumentation#ExperimentConfiguration Experiment Configuration] section below on on how to configure your HARMONIE experiment.
=== Local platform ===
Below are links on how the start running HARMONIE on your local platform. It is assumed that a valid host configuration has been made available to you. If you are really starting from scratch you should first look at the [wiki:HarmonieSystemDocumentation#Installation Installation] and [wiki:HarmonieSystemDocumentation#Downloadinputdata input data] sections.
 * [wiki:HarmonieSystemDocumentation/40h1.1/QuickStartLocal Running Harmonie]: A guide to running your first Harmonie experiment on your local platform
 * [wiki:HarmonieSystemDocumentation/40h1.1/TheHarmonieScript The Harmonie script]: The ''Harmonie'' script and how to use it
 * [wiki:HarmonieSystemDocumentation/40h1.1/ModelDomain Model domain]: How to define a new model domain for your first experiment
Have a look at the [wiki:HarmonieSystemDocumentation#ExperimentConfiguration Experiment Configuration] section below on on how to configure your HARMONIE experiment.

== '''Installation''' ==
This section deals with installing HARMONIE on non-ECMWF platforms with some background information on the two build systems available, ''Makeup'' and ''GMKPACK''.
 * [wiki:HarmonieSystemDocumentation/40h1.1/General General software requirements]: Prepare your platform by installing software packages required by HARMONIE
  * [wiki:HarmonieSystemDocumentation/40h1.1/Redhat7Install Redhat 7]: specific software requirements/installation instructions for CentOS/Redhat 7 platforms
  * ~~[wiki:HarmonieSystemDocumentation/40h1.1/Centos6Install CentOS 6]: specific software requirements/installation instructions for CentOS 6 platforms~~. Please note: the version of gcc/gfortran available on CentOS/Redhat 6 platforms ((GCC) 4.4.7 !20120313 (Red Hat 4.4.7-16)) is not recent enough to compile harmonie-40h1.1. gcc/gfortran, netCDF and HDF5 must be installed locally.

 * [wiki:HarmonieSystemDocumentation/40h1.1/PlatformConfiguration Platform configuration]: A general description of required configuration files and a summary of those already available in HARMONIE.

 * There are two options available for compiling HARMONIE source code ''Makeup'' and ''GMKPACK''. ''Makeup'' is currently default.
  * [wiki:HarmonieSystemDocumentation/40h1.1/Build_with_makeup Compilation using Makeup]: How to compile HARMONIE source code using ''Makeup''
  * [wiki:HarmonieSystemDocumentation/40h1.1/Installation Compilation using GMKPACK]: How to compile HARMONIE source code using ''GMKPACK''
 * Source code CPP macros explained [https://hirlam.org/trac/attachment/wiki/HarmonieSystemDocumentation/cpp_macros.odt odt], [https://hirlam.org/trac/attachment/wiki/HarmonieSystemDocumentation/cpp_macros.pdf pdf]: Overview of cpp macros used in the source code of ARPEGE/IFS and ALADIN/AROME/HARMONIE - (CY36T1)

== '''Download input data''' ==
Before you can start running HARMONIE experiments some input data (external from the code repository) needs to be available on your platform. The input data contains physiography data, topography information and climatological values determined from a one year ARPEGE assimilation experiment with a resolution of T79.
  * [https://hirlam.org/portal/download/harmonie_climate/38h1.1.tar.gz harmonie_climate/38h1.1.tar.gz]: Climate and physiography data for cy38h1
  * [https://hirlam.org/portal/download/harmonie_climate/40h1_increment_to_38h1.1.tar.gz harmonie_climate/40h1_increment_to_38h1.1.tar.gz]: Climate and physiography data "increment" for cy40h1
  * [https://hirlam.org/portal/download/sat_const/sat_const_cy38h1.2.tar.gz sat_const/sat_const_cy38h1.2.tar.gz]: Satellite constants
  * [https://hirlam.org/portal/download/testbed/38h1/38h1.tar Testdata set with boundaries and observations for a small 50x50 domain]

== '''Experiment Configuration''' ==
This section provides information on how to configure your HARMONIE experiment: definition of input/output locations, how to assimilate observations, define forecast cycles, post-processing options and much more! For the expert user there is information on how model namelists are set up HARMONIE.
 * [wiki:HarmonieSystemDocumentation/40h1.1/ConfigureYourExperiment Configure your experiment] - setting of environment variables in [source:tags/harmonie-40h1.1/sms/config_exp.h sms/config_exp.h] explained
 * [wiki:HarmonieSystemDocumentation/40h1.1/Namelists Finding the right namelist]: more details on the namelist settings in HARMONIE (if you are prepared to get your hands dirty!)

== '''Suite management''' ==
From cy40h1 users have the option to use either mini-SMS or ecFlow to manage the execution of their HARMONIE experiments.

 * [wiki:HarmonieSystemDocumentation/40h1.1/scripts/mSMS A few words about mSMS]
  * [https://hirlam.org/UG/HL_Documentation/mSMS/SMS Documentation of the original ECMWF full SMS]
  * [https://hirlam.org/UG/HL_Documentation/mSMS/mSMS_CLI.html mSMS interface: command line and environment]
  * [https://hirlam.org/UG/HL_Documentation/mSMS/mXCdp mini-XCdp: graphical display] with an [wiki:HarmonieSystemDocumentation/40h1.1/scripts/mXCdp update]
 * [wiki:HarmonieSystemDocumentation/40h1.1/ECFLOW Running Harmonie under ECFLOW]

== '''NWP Components''' ==
=== Domain definition ===
 * [wiki:HarmonieSystemDocumentation/40h1.1/ModelDomain Model domain]: Horizontal model domain information
 * [wiki:HarmonieSystemDocumentation/40h1.1/VerticalGrid Vertical grid]: Vertical model level definitions
=== Climate generation ===
  * [wiki:HarmonieSystemDocumentation/40h1.1/ClimateGeneration Climate Generation]
  * [wiki:HarmonieSystemDocumentation/40h1.1/How_to_use_hires_topography How to upgrade to high-resolution topography]
=== Initial/boundary data ===
   * [wiki:HarmonieSystemDocumentation/40h1.1/BoundaryFilePreparation Initial and Lateral Boundary Interpolation]
   * [wiki:HarmonieSystemDocumentation/40h1.1/PostPP/gl/Interpolation Interpolations with gl ]
=== Observations ===
   * [wiki:HarmonieSystemDocumentation/40h1.1/UseofObservation Use of observations] ([wiki:HarmonieSystemDocumentation/40h1.1/UseofObservation?format=pdfarticle pdf]): selection of observation types and blacklisting using Bator
   * [wiki:HarmonieSystemDocumentation/40h1.1/ObservationPreprocessing Preprocessing of observation data] ([wiki:HarmonieSystemDocumentation/40h1.1/ObservationPreprocessing?format=pdfarticle pdf]): Introduction 
    * [wiki:HarmonieSystemDocumentation/40h1.1/ObservationPreprocessing/ObservationData ObservationData] ([wiki:HarmonieSystemDocumentation/40h1.1/ObservationPreprocessing/ObservationData?format=pdfarticle pdf]): Observation data
    * [wiki:HarmonieSystemDocumentation/40h1.1/ObservationPreprocessing/Oulan Oulan] ([wiki:HarmonieSystemDocumentation/40h1.1/ObservationPreprocessing/Oulan?format=pdfarticle pdf]): Oulan - extraction of conventional data and production of OBSOUL file read by BATOR
    * [wiki:HarmonieSystemDocumentation/40h1.1/ObservationPreprocessing/Bator Bator] ([wiki:HarmonieSystemDocumentation/40h1.1/ObservationPreprocessing/Bator?format=pdfarticle pdf]): Bator - preparation of ODBs used by data assimilation
    * [wiki:HarmonieSystemDocumentation/40h1.1/ObservationPreprocessing/Cope Cope] ([wiki:HarmonieSystemDocumentation/40h1.1/ObservationPreprocessing/Cope?format=pdfarticle pdf]): COPE - preparation of ODBs used by data assimilation - not available yet
   * Observation usage "how-tos":
     * [wiki:HarmonieSystemDocumentation/40h1.1/ObservationHowto/Amv Atmospheric motion vectors] ([wiki:HarmonieSystemDocumentation/40h1.1/ObservationHowto/Amv?format=pdfarticle pdf]): How to process and assimilate AMVs
     * [wiki:HarmonieSystemDocumentation/40h1.1/RadarData (OPERA) radar data] ([wiki:HarmonieSystemDocumentation/40h1.1/RadarData?format=pdfarticle pdf]): Assimilate OPERA (HDF5) radar data
     * [wiki:HarmonieSystemDocumentation/40h1.1/ObservationHowto/GNSS GNSS ZTD data] ([wiki:HarmonieSystemDocumentation/40h1.1/ObservationHowto/GNSSZTD?format=pdfarticle pdf]): How to process and assimilate GNSS ZTD data

   * [wiki:HarmonieSystemDocumentation/40h1.1/Conrad CONRAD: radar data pre-processing] ([wiki:HarmonieSystemDocumentation/40h1.1/Conrad?format=pdfarticle pdf])
   * [wiki:HarmonieSystemDocumentation/40h1.1/StandaloneOdb ODB: software, data and visualization] ([wiki:HarmonieSystemDocumentation/40h1.1/StandaloneOdb?format=pdfarticle pdf])

=== Data Assimilation ===
   * [wiki:HarmonieSystemDocumentation/40h1.1/Analysis/SurfaceAnalysis Surface Data Assimilation] ([wiki:HarmonieSystemDocumentation/40h1.1/Analysis/SurfaceAnalysis?format=pdfarticle pdf])
   * 3D-VAR:
    * [wiki:HarmonieSystemDocumentation/40h1.1/Structurefunctions_ensys Structure functions]: How to derive structure functions on cca (at ECMWF) ([wiki:HarmonieSystemDocumentation/40h1.1/Structurefunctions_ensys?format=pdfarticle pdf])
    * [wiki:HarmonieSystemDocumentation/40h1.1/Screening Screening]: Quality control of observations task ([wiki:HarmonieSystemDocumentation/40h1.1/Screening?format=pdfarticle pdf])
    * [wiki:HarmonieSystemDocumentation/40h1.1/SingleObs_ensys Single observation test]: How to run a single observation test ([wiki:HarmonieSystemDocumentation/40h1.1/SingleObs_ensys?format=pdfarticle pdf])
    * [wiki:HarmonieDAWorkshop200805 DA working week 200805]: Information out of date now?
    * [wiki:HarmonieSystemDocumentation/40h1.1/ObservationOperators Observation operators (HOP_DRIVER)] ([wiki:HarmonieSystemDocumentation/40h1.1/ObservationOperators?format=pdfarticle pdf])
    * [wiki:HarmonieSystemDocumentation/40h1.1.1/graphviz Data Assimilation Flow Chart]
    * [wiki:HarmonieSystemDocumentation/40h1.1.1/LETKF LETKF]
    * [wiki:HarmonieSystemDocumentation/40h1.1.1/HYBRID Hybrid 3DVAR-LETKF] 
   * Assimilation diagnostics:
    * MTEN ...
    * [wiki:HarmonieSystemDocumentation/40h1.1/DFS DFS]
    * Observation impact diagnostics [https://hirlam.org/trac/attachment/wiki/HarmonieSystemDocumentation/DesroziersHarm.tar.gz]

=== Digitial Filter Initialization ===
 * [wiki:HarmonieSystemDocumentation/40h1.1/DigitialFilterInitialization Digitial Filter Initialization]: Brief description of how to use DFI in HARMONIE. (Not used by default)
=== Forecast Model ===
 * [wiki:HarmonieSystemDocumentation/40h1.1/Forecast Forecast model]: A description of the [source:tags/harmonie-40h1.1/scr/Forecast Forecast script] and some of the more important namelist settings
 * [wiki:HarmonieSystemDocumentation/40h1.1/Forecast/Outputlist/40h1 40h1 model output]: Information on FA and GRIB output available from HARMONIE. (GRIB table information also included). '''To be created! Use 38h1 info for now.'''
 * [wiki:HarmonieSystemDocumentation/Forecast/Outputlist/38h1 38h1.1 model output]: Information on FA and GRIB output available from HARMONIE 38h1. (GRIB table information also included).
  * [wiki:HarmonieSystemDocumentation/40h1.1/PreviousModelOutputLists Previous output lists]: Links to model output documentation valid for previous HARMONIE versions

=== Ensemble prediction (HarmonEPS) ===
  * [wiki:HarmonieSystemDocumentation/EPS/Howto How to run an ensemble experiment]
  * [wiki:HarmonieSystemDocumentation/EPS/System Ensemble mode in the script system]
  * [wiki:HarmonieSystemDocumentation/EPS/BDSTRATEGY Available boundary strategies]
  * [wiki:HarmonieSystemDocumentation/EPS/Testperiods Available test periods for HarmonEPS]
  * [wiki:HarmonieSystemDocumentation/EPS/SLAF How to use SLAF]
  * [wiki:HarmonieSystemDocumentation/EPS/SurfacePerturbations Surface perturbations]
  * [wiki:HarmonieSystemDocumentation/EPS/Explist_paper List of experiments for HarmonEPS paper 2018]
  * [wiki:HarmonieSystemDocumentation/EPS/SPPT SPPT (under construction)]
  * [wiki:HarmonieSystemDocumentation/EPS/SPP SPP (under construction)]
  * [wiki:HarmonieSystemDocumentation/40h1.1.1/LETKF LETKF]

=== Climate simulations (HCLIM) ===
  * [wiki:HarmonieSystemDocumentation/40h1.1/ClimateSimulation How to run a climate simulation]
  * [wiki:HarmonieClimate HARMONIE Climate]: communication of status, development and documentation of HARMONIE Climate (HCLIM)

=== Single column model (MUSC) ===
 * The README files for ecgb ([source:branches/harmonie_MUSC_cy40h1/README_ecgb README_ecgb]) and Redhat 7 PCs ([source:branches/harmonie_MUSC_cy40h1/README_redhat7 README_redhat7]) provide the most up to date documentation on MUSC
 * [wiki:MUSC MUSC, Harmonie single column model]: From 2011 Working week. Out of date now?
 
== '''Postprocessing''' ==
 * [wiki:HarmonieSystemDocumentation/40h1.1/PostPP Postprocessing overview] 
   * [wiki:HarmonieSystemDocumentation/40h1.1/PostPP/FileConversions Convert data to GRIB]
   * [wiki:HarmonieSystemDocumentation/40h1.1/PostPP/Fullpos Postprocessing with FULL-POS]
   * [wiki:HarmonieSystemDocumentation/40h1.1/PostPP/gl Postprocessing with gl]
   * [wiki:HarmonieSystemDocumentation/40h1.1/PostPP/gl_grib_api Postprocessing with gl_grib_api]
   * [wiki:HarmonieSystemDocumentation/40h1.1/PostPP/xtool Postprocessing with xtool]
   * [wiki:HarmonieSystemDocumentation/40h1.1/PostPP/Diagnostics Diagnostics]
   * [wiki:HarmonieSystemDocumentation/40h1.1/PostPP/Obsmon Obsmon]

== '''Verification''' ==

 * [wiki:HarmonieSystemDocumentation/40h1.1/PostPP/Extract4verification Extract data for verification]
 * [wiki:HarmonieSystemDocumentation/40h1.1/PostPP/Verification Deterministic verification (monitor)]
 * [wiki:HARP Ensemble verification (HARP)]
 * [wiki:HirlamSystemDocumentation/PostPP/CommonVerification Multi-model Observation Verification Intercomparison]
 * [wiki:HarmonieSystemDocumentation/40h1.1/PostPP/Obsmon Observations monitoring]


== '''System: For the hard core system staff''' ==
  * [wiki:HarmonieSystemDocumentation/40h1.1/UpdateNamelists Create new namelists]: How to create new namelists to be used by HARMONIE

  * [wiki:HarmonieSystemDocumentation/40h1.1/Evaluation/HarmonieTestbed Harmonie testbed]: The HARMONIE test environment used to test typical configurations on a small domain

  * [wiki:HarmonieSystemDocumentation/40h1.1/Phasing Phasing instructions]
   * [wiki:HarmonieSystemDocumentation/40h1.1/MFaccess Access to Météo-France servers]
   * [wiki:HarmonieSystemDocumentation/40h1.1/Evaluation/Mitraillette Mitraillette]

  * [wiki:HarmonieSystemDocumentation/40h1.1/DrHook Profiling with DrHook]: ECMWF's profiling and traceback tool included in the code
  * [wiki:HarmonieSystemDocumentation/40h1.1/HarmonieBenchMark HARMONIE RAPS benchmark]
  * Meteo France/ECMWF 2011: [http://www.cnrm.meteo.fr/gmapdoc/spip.php?article213 Coding standards for ARPEGE-IFS]

  * [wiki:HarmonieSystemDocumentation/40h1.1/Scalability_and_Refactoring Scalability and refactoring]: Preliminary documents, presentations and links

  * Coordination documents
    * [http://www.cnrm.meteo.fr/aladin/spip.php?article219&lang=en OOPS & technical video meeting minutes]
    * [http://www.cnrm.meteo.fr/aladin/spip.php?article170&lang=en Coordination meeting minutes]
    * [http://www.cnrm.meteo.fr/aladin/spip.php?article124&lang=en Technical memorandums]

== '''Code browsers''' ==

  * [https://hirlam.org/codebrowser/ Code browsers (ftagshtml), 36h1.3, 37h1.1, 38h1.beta.1]
  * [https://hirlam.org/portal/doxygen_browser/cy36h1.4/ Doxygen code browser (36h1.4)]
  * [source:tags/harmonie-40h1.1/ Trac code browser]

== '''HARMONIE Reference materials''' ==

 * '''[http://www.cnrm.meteo.fr/gmapdoc/spip.php?rubrique1 Excellent ALADIN/Arome documentation]'''
 * [http://www.ecmwf.int/research/ifsdocs IFS documentation]
 * [http://www.cnrm-game-meteo.fr/surfex/ SURFEX documentation]
 * Meteo France/ECMWF 2011: [http://www.cnrm.meteo.fr/gmapdoc/spip.php?article213 Coding standards for ARPEGE-IFS]
 * Guidard Vincent and C. Fischer, [https://hirlam.org/trac/attachment/wiki/HarmonieDAWorkshop200805/Guidard_3DVAR_theory.ppt ALADIN 3D-Var Theory and Practice]
 * Kert'esz, S., 2001: [http://www.cnrm.meteo.fr/gmapdoc/spip.php?article64 A short overview of ODB]
 * Kert'esz, S., 2002: Using ODB in ALADIN. Internal note, 21pp, available on "http://www.cnrm.meteo.fr/gmapdoc/" (topics "ODB")
 * [https://hirlam.org/trac/attachment/wiki/HarmonieSystemDocumentation/report.pdf M. Lindskog, 2010: Study with extended extension zone, manuscript for HIRLAM Newsletter 2010]
 * R. Roger, [https://hirlam.org/trac/attachment/wiki/HarmonieDAWorkshop200805/R_Roger_data_handeling.ppt The data flow in HARMONIE data assimilation ]
 * S. Saarinen: [https://hirlam.org/trac/attachment/wiki/HarmonieSystemDocumentation/AROME_2_ECMWF_20nov2009v5.pdf Initial Optimisation of AROME forecasts on FMI's Cray XT5m, Presentation at ECMWF, Nov 20 2009]
 * [https://hirlam.org/trac/attachment/wiki/HarmonieSystemDocumentation/Drag_orog_report.pdf Yann Seity's unofficial documentation about Surfex surface drag options]. Note the options described are those featured in CY36 and CY38, and some of the options for CY38 need back porting to CY37.
 * Trojakova Alena, [https://hirlam.org/trac/attachment/wiki/HarmonieDAWorkshop200805/Trojakova_canari_2.ppt CANARI optimum interpolation with emphasis on technical aspects ]
 * Yessad K.: Aug 2007: [http://www.cnrm.meteo.fr/gmapdoc/spip.php?article23 LIBRARY ARCHITECTURE AND HISTORY OF THE TECHNICAL ASPECTS IN ARPEGE/IFS, ALADIN AND AROME IN THE CYCLE 32T2 OF ARPEGE/IFS]
 * Yessad, K., 2007: [http://www.cnrm.meteo.fr/gmapdoc/spip.php?article29 Basics about ARPEGE/IFS, ALADIN and AROME in the cycle 32T2 of ARPEGE/IFS]
 * Vignes, O., 2011: [https://hirlam.org/trac/attachment/wiki/HarmonieSystemDocumentation/lsmixbc.ppt Short presentation of LSMIXBC option]
 * Bengtsson, L., 2014: [https://hirlam.org/trac/attachment/wiki/HarmonieSystemDocumentation/progress_report_CA.pdf CA scheme description]
----

[[Disclaimer]]

[[Center(begin)]]
[[Color(red, Last modified on)]] [[LastModified]]
[[Center(end)]]