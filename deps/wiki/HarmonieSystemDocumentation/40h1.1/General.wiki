[[PageOutline]]

[[Center(begin)]]
= '''Harmonie System Documentation''' =
== '''General software requirements''' ==
[[Center(end)]]

This page outlines, in a general way, the software requirements for compiling HARMONIE on a non-ECMWF platform
=== Download HARMONIE ===

To obtain the HARMONIE source, assuming the computer platform has svn client available, one may check out from the repository at the host hirlam.org:
{{{
svn export https://svn.hirlam.org/tags/harmonie-38h1.2          # for the latest tagged "official" release (stable) HARMONIE system
svn export https://svn.hirlam.org/tags/harmonie-40h1.1.beta.4   # for the latest tagged (stable) HARMONIE system
svn export https://svn.hirlam.org/trunk/harmonie                # for the latest updated (unstable) version
}}}

At ECMWF, the "checked-out" versions are available on ecgb:
{{{
ecgb:/home/ms/spsehlam/hlam/harmonie_release/tags/harmonie-38h1.2
ecgb:/home/ms/spsehlam/hlam/harmonie_release/tags/harmonie-40h1.1.
ecgb:/home/ms/spsehlam/hlam/harmonie_release/trunk
}}}

Export versions are also available to download from hirlam.org:
 * [https://hirlam.org/portal/download/harmonie-38h1.2.tar.gz https://hirlam.org/portal/download/harmonie-38h1.2.tar.gz]
 * [https://hirlam.org/portal/download/harmonie-40h1.1.beta.3.tar.gz https://hirlam.org/portal/download/harmonie-40h1.1.tar.gz]

=== Compilers and standard software ===

The system requires the following standard unix/linux software 

 * A fortran compiler
 * A C compiler
 * flex & bison for lex & yacc
 * ksh and bash
 * perl
 * python

Read more about the tested compilers under [wiki:HarmonieSystemDocumentation/40h1.1/Installation installation].

=== MPI and OpenMP ===

Harmonie supports parallelization through message passing or shared memory multiprocessing. 

 * mpi libraries such as mpich2, openmpi or similar.
 * OpenMP libraries

The system can be compiled without support for MPI, but not all parts of the system can be run without MPI. The forecast model should however work fine without MPI.

=== BLAS and LAPACK libraries ===

You need [http://netlib.org/ BLAS and LAPACK-lite] libraries.

If they are already on your system, verify they have been made with the correct compiler, or rebuild them. Instructions on how to (re-)build BLAS and LAPACK follow below:
 * Download [http://www.netlib.org/blas/index.html BLAS] and [http://www.netlib.org/lapack/index.html LAPACK]
 * First build BLAS (untarring blas.tgz places it in the BLAS directory). Go to that directory, and edit make.inc to set the compiler and linker to '''gfortran'''. Then type 'make'.
 * Subsequenty, for LAPACK, after untarring lapack-lite-3.1.1.tgz, go to the lapack-lite-3.1.1 directory.
 * Copy make.inc.example to make.inc.
 * Edit make.inc to point to the proper compiler/loader ('''gfortran''') and to put the variable PLAT to the empty string. Set TIMER to INT_ETIME.
 * Copy the blas.a library from the BLAS directory to the lapack-lite-3.1.1 directory, run ranlib on it, then type 'make'.
 * Then copy the libraries in '''/usr/local/lib''' with names libblas.a and liblapack.a, respectively, otherwise the default configuration will not find them. Run ranlib on them.

=== NETCDF ===

 Netcdf is required for some routines. Make sure you have development version installed on your system.

 http://www.unidata.ucar.edu/software/netcdf

=== GRIB, BUFR and auxiliary software ===

The software for reading GRIB and BUFR is included in the HARMONIE system and comprises

 * grib-api 1.10.4
 * bufr 000405
 * gribex 000370

In addition there are some extra support libraries.

 * dummies_006
 * rgb_001


If you compile with [wiki:HarmonieSystemDocumentation/40h1.1/Build_with_makeup Makeup] these are built for you. If you use gmkpack you have to build them yourself. For grib-api follow the instructions. For the other libraries follow the instructions below. Read more in the [source:tags/harmonie-40h1.1/util/auxlibs/README README file].

In each of the directories in auxlibs, run the script ./build_library.  You'll have to answer the following
questions:

 * Which compiler to use
 * Whether you want 64 bit reals (yes)
 * Where to store the library on completion of the build (choose a subdirectory of your home directory
   where you have write permission - note: full path; e.g. the GFORTRAN.LINUX configuration assumes these
   libraries are in $HOME/auxlibs and include files in $HOME/auxinclude)
 
After build_library finishes, run ./install - this will put the library in the directory you've chosen above. 

=== Perl requirements ===

For the mini-SMS server/client communication and to be able to launch the mSMS mXdcp window you need to have the following modules installed

 * Tk
 * HTTP
 * Data
 * Cwd
 * Errno
 * Config

You can define PERL_TK and PERLTKDIR in your system config file.

=== GMTED processing ===

 To process the GMTED tiff files gdal and pyhon modules for gdal is required.

=== Observation monitoring ===

 To be able to extract observation feedback information sqlite3 is required.


[[Center(begin)]]
[wiki:HarmonieSystemDocumentation Back to the main page of the HARMONIE System Documentation]
[[Center(end)]]
----

[[Center(begin)]]
[[Disclaimer]]

[[Color(red, Last modified on)]] [[LastModified]]
[[Center(end)]]
