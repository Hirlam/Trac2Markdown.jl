[[PageOutline]]

[[Center(begin)]]
= '''Harmonie System Documentation''' =
== ''' Generation of climate and physiography files''' ==
[[Center(end)]]

== Introduction ==

The generation of climate files includes two parts. The first part is the generation of climate files for the atmospheric model, the so called 
[http://www.cnrm.meteo.fr/gmapdoc/spip.php?page=recherche&recherche=e923 e923] configuration. The second part is the generation of the physiography information for 
[http://www.cnrm-game-meteo.fr/surfex/ SURFEX]. In the following we describe how it is implemented in HARMONIE.

[[Image(Screenshot-10.png)]][[BR]]
''Climate generation in mSMS''

== Input data for climate generation ==
The location of your input data for the climate generation is defined by the '''HM_CLDATA''' environment variable defined in the [source:tags/harmonie-40h1.1/config-sh/config.ecgb-cca config.yourhost] file. At ECMWF the climate data is stored on cca here:
{{{ cca:/ms_perm/hirlam/harmonie_climate }}}

Information on what data to download is available here: [wiki:HarmonieSystemDocumentation#Downloadinputdata]. The input data contains physiography data, topography information and climatological values determined from a one year ARPEGE assimilation experiment with a resolution of T79. 

== Preparation of SURFEX physiography file ==

At present the most applied configuration is to run with SURFEX as the surface scheme. SURFEX needs information about the distribution of different available tiles like nature, sea, water and town. The nature tile also needs information about type of vegetation and soiltypes. The main input sources for this are found at [http://www.cnrm-game-meteo.fr/surfex/spip.php?rubrique14 SURFEX physiographic maps].

The data base for SURFEX-file preparation is located under HM_CLDATA/PGD
 * ecoclimats_v2.* : Landtypes
 * gtopo30.* : Topography
 * sand_fao.* : Soil type distribution
 * clay_fao.* : Soil type distribution

The generation of SURFEX physiography file ('''PGD.lfi''') is done in [source:tags/harmonie-40h1.1/scr/Prepare_pgd Prepare_pgd]. The script creates the namelist OPTIONS.nam based on the ''DOMAIN'' settings in [source:tags/harmonie-40h1.1/scr/Harmonie_domains.pm Harmonie_domains.pm]. Note that the SURFEX domain is only created over the C+I area. In the namelist we set which scheme that should be activated for each tile.
 || |||||||||| Tile || 
 ||= PHYSICS =||= Nature =||= Sea =||= Water =||= Town =||
 ||AROME  ||ISBA  ||SEAFLX||WATFLX ||TEB         ||
 ||ALARO  ||ISBA  ||SEAFLX||WATFLX ||Town as rock||

The program PGD produces one SURFEX physiography file ('''PGD.lfi'''), which is stored in ''CLIMDIR'' directory.

To make sure we have the same topography input for the atmospheric part we call Prepare_pgd two times. One time to produce a PGD.lfi for SURFEX and a second time to produce a PGD.fa file that can be used as input for the climate generation described below. Note that for the atmosphere the topography will be spectrally filtered and the resulting topography will be imposed on SURFEX again.
 
== Generation of a non SURFEX climate file ==

[source:tags/harmonie-40h1.1/scr/Climate Climate] is a script, which prepares climate file(s) for 
prefered forecast range. Climate files are produced for past, present and following month. The outline of '''Climate''' is as follows:

 * Check if climate files already exists.
 * Creation of namelists. The definition of domain and truncation values is taken from [source:tags/harmonie-40h1.1/scr/Harmonie_domains.pm Harmonie_domains.pm].
 * Part 0: Read the PGD.fa file generated by SURFEX and write it to Neworog
 * Part 1: Filter  __Neworog__ to target grid with spectral smoothing to remove 2dx waves.
 * Part 2: generation of surface, soil and vegetation variables, without annual variation.
 * Part 3: creation of monthly climatological values and  modification of albedo and emissivity according to the climatology of sea-ice limit.
 * Part 4: definition and modification of the vegetation and surface characteristics
 * Part 5: modification of fields created by step 2 and 4 over land from high resolution datasets (for each month)
 * Part 6: modification of climatological values
 
 The result is climate files for the previous, current and next month. The files are named after their month like '''m01''', '''m02''' - '''m12''' and stored in ''CLIMDIR''.

Further reference [http://www.cnrm.meteo.fr/gmapdoc/IMG/ps/e923_users.ps e923]

[[Center(begin)]]
[wiki:HarmonieSystemDocumentation Back to the main page of the HARMONIE System Documentation]
[[Center(end)]]
----

[[Center(begin)]]
[[Disclaimer]]

[[Color(red, Last modified on)]] [[LastModified]]
[[Center(end)]]
