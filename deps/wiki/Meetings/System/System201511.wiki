[[PageOutline]]
[[Center(begin)]]
= '''HARMONIE System Working Week''' =
''Bratislava, 9th - 13th of November 2015''

[[Image(IMG_7466_x.jpg, 30%)]][[Image(IMG_7468_x.jpg, 30%)]]


Last modified [[LastModified]]
[[Center(end)]]


== Practical ==

The HARMONIE system Working Week will take place in the premises of SHMU, in the nice and stimulating environment of Koliba Hill, Jeseniova 17, Bratislava: 
 http://mapa.zoznam.sk/?search=Jes%C3%A9niova%2017%2C%20Bratislava&z=18&mc=h

Working week will start on Monday 9/11/2015 at 13:00 in the meeting room (kinosala), building D, the first floor. Please, use the SHMU main entrance from the Vancurova street. There will be labels within the SHMU building to navigate you to the meeting room. 

* Participants, arrival, departure, hotel:
 * SMHI: Ulf Andrae, Sunday ~2300, Friday ~1700, hotel: Tatra
 * SHMU: Maria Derkova, Olda Spaniel
 * RMI: Piet Termonia (Wed evening, Thur evening), Rafiq Hamdi, Olivier Giot ( Tue evening, Fri morning)
 * AEMET: Daniel Santos, Monday ~1000, Friday ~8000. Hotel: Tatra MAC address laptop: WIFI: 48:D7:05:D4:26:59 ETH: E8:80:2E:E7:14:C9
 * KNMI: Toon Moene, Monday ~1300, Friday ~1300. Hotel: Tatra. MAC address laptop: E0:06:E6:68:FD:15
 * METIE: Eoin Whelan, Monday ~1400, Friday ~1100, Hotel: Tatra. MAC address laptop (EWhelan-LT-8): 28:B2:BD:5C:EC:BB
 * SMHI: Patrick Samuelsson, Anna Fitch: Tuesday ~2300, Friday ~0800, hotel Tatra
 * IMO: Bolli Palmason, Friday 6.11 ~2100, Saturday ~0500, hotel Tatra. MAC address laptop: C0:D9:62:37:3A:7C
 * met.no: Ole Vignes, Monday ~1400, Friday ~0800, hotel Tatra. MAC address laptop: WIFI: 18:3d:a2:ad:38:7c, ETH: 5c:26:0a:19:45:81
 * Croatia: Martina Tudor, to Vienna, arrival at 9:10 on Monday 9 Nov and departure on Friday 19:35 from Vienna​
 * NMA Romania: Simona Briceag (Stefanescu), arrival Sunday 14:30, departure Saturday 15:15, Hotel: Tatra
 * FMI: Niko Sokka, Monday Vienna arrival 9:45, Friday Vienna departure 19:15, Hotel Saffron. Laptop wifi MAC address: 00-21-6A-71-3B-46


 === Transport ===

As there are not so many flights to Bratislava, the access via Vienna airport is commonly used. 

From Schwechat there are regular and frequent buses to Bratislava available with two companies: 
http://www.eurolines.sk/fileadmin/user_upload/cestovne_poriadky/mal_new/wien_new.pdf
http://www.blaguss.sk/media/bratislava-vieden%20blaguss%2006.08.2012.pdf
One way ticket is 7-10 EUR, the journey takes ~50 min. Tickets can be bought at the reservation centre at Vienna Airport arrival hall (on your left after leaving the large door) or in case of late arrival directly from the bus driver. With Slovak lines you will be charged additional 1-2EUR for luggage if put to bus luggage compartment. The bus stop is on your right after leaving the arrival hall, usually platform No. 4. With Slovak Lines you should buy the ticket to the main bus station Mlynske Nivy. With Blaguss the name of your station is “Most SNP” or “New Bridge”.

Another option is to order a private transport by "taxi" (fully official and legal, with recipe etc). If organized from Slovakia the price is ~40EUR one way. The driver would wait for you at the airport and drive you directly to the hotel or to the Institute. Let us know in case you wish to arrange it.

 === Accomodation ===

Proposed accommodation is in Hotel Tatra (http://www.hoteltatra.sk/), situated directly in the city center while providing easy direct access to SHMU premises by trolleybus. You are invited to contact the hotel directly (rezervacie@hoteltatra.sk) to book your accommodation, mentioning the keyword SHMU and reservation number 45732 in your reservation. The price is 45EURO including breakfast + 1.7EUR city tax. Hotel parking 17EUR/night. Reservation is guaranteed till 24/10/2015. Another posibility at city center is IBIS hotel (http://www.ibis.com/gb/hotel-3566-ibis-bratislava-centrum/index.shtml). Pension Zlata noha is within walking distance from SHMU (http://www.en.zlatanoha.sk/).


 === Food ===
We propose to use SHMU canteen for the lunches to save time. There are usually 5 menus to choose (one day in advance). The price is max 4EUR. Please, let us know in case you have any special diet requirements or do not wish to take the lunch at all.

 === Special requirement ===

The MAC address of your laptops would be needed (in advance) in order to be able to connect to network.

== Agenda ==

 * Monday: Drop in. 14.00(?) Goals and tasks for the week and next year
   * Plans for the week
   * HARMONIE (Ulf) [https://hirlam.org/trac/attachment/wiki/HarmonieWorkingWeek/System201511/UA_system_general_bratislava.pdf pdf]
   * COPE (Eoin) [https://hirlam.org/trac/raw-attachment/wiki/HarmonieWorkingWeek/System201511/cope_bratislava_2015_eoin.pdf pdf]
   * Obs operator work (Eoin) [https://hirlam.org/trac/raw-attachment/wiki/HarmonieWorkingWeek/System201511/refactor_bratislava_2015_eoin.pdf pdf]
   * IFS-ARPEGE status and plans
 * Tuesday: Hard work
   * 09.00 status update
 * Wednesday: Hard work
   * 09:00 status update
 * Thursday: ALADIN-HIRLAM system cooperation discussion [https://hirlam.org/trac/attachment/wiki/HarmonieWorkingWeek/System201511/UA_TH_status.pdf pdf]
   * 09:00 status update
 * Friday: Wrapup 
   * 09:00 status update

=== SURFEX ===

 * ALARO1/ALARO0 coupling with SURFEX (Rafiq,Patrick,Anna,Olda,Simona,Ulf) '''Ongoing'''
  * The setup for ALARO1+SURFEX given in https://svn.hirlam.org/branches/harmonie-40h1_alaro1_surfex has been tested with three different compilers (xlf,gnu,intel) on a small 50x50 domain. A five day simulation runs to an end but for two of the platforms the MPI reproducibility has been tested and it was noted that the result changes with both the decomposition and the number of MPI tasks. A rerun with the same code without SURFEX doesn't have this problem so we can suspect that there is something wrong in the SURFEX changes.
  * The implementation of the ALARO to SURFEX interface in cy40t1 has been inspected and compared with the one in cy38t1 and the changes looks fine. The drag coefficients (PCD,PCDN) has been stored in an available RK gfl array and this will be implemented properly by Patrick as a surface field to propagate the value between time steps. Olda has cleaned the changes to fit with cy40t1_bf.05 and Rafiq will together with a Algerian(?) colleague go through this during the coming two weeks. 
 * Intital non-surfex surface conditions from a ARPEGE-SURFEX run (Oliver, Mariska). There is a need to prepare technical steps that will enable to create initial conditions to run ALADIN with ISBA surface scheme coupled to ARPEGE with SURFEX (next operational configuration of Meteo-France). This was already solved by Belgian team for climate simulations, but with different SURFEX version. The set of e-suite ARPEGE files with SURFEX were made available by MF, however the procedure was not repeated successfully with those files yet. It has to be adapted for the new cycle first (ongoing). The technical report will be written after it runs correctly (draft already available).

=== HARMONIE ===

 * harmonie-40h1
  * DFI-blending (Martin) '''Ongoing'''
    * The work on DFI-blending initiated last year yn cy38h1 has been resumed. Harmonie assumes equal grid distance in x and y-direction which is not the case for e.g. the SHMU operational domain.
  * Reproducibility between cy40t1_bf.05 and harmonie-40h1.1.beta.4. (Niko, Ulf) '''Ongoing'''
    * ALARO1 forecast model only: Bit reproducible. No further action.
    * AROME-MF forecast model only: Not reproducible with physics switch on. For an adiabatic run with the PC-scheme it's fully reproducible.
    * e923/PGD
      * Some efforts where done to check the possibility to have consistency between T and H for the climate generation. The input data used is different but this easly handled through options. For the source code used we noted that would be very difficult to guarantee consistency since the climate generation procedure at Meteo France are clearly based on a variety of code versions and that there are no clear reference.
        - ECOCLIMAP input files are different v1.6 for ALADIN vs v2.2 for HARMONIE. v1.6 would be available in HARMONIE trough the variable ECOCLIMAP_VERSION.
        - Sand and clay input files are different HWSD_v2 vs FAO. Both options are available in HARMONIE through the variable SOIL_TEXTURE_VERSION.
        - Orography input data is different but converging. ALADIN is using GMTED2010 data and HARMONIE is moving in this direction. The GMTED2010 file assembled by Meteo France has been made available for testing on cca. The different choices of input data for the orography are available through the variable TOPO_SOURCE.
        - The binaries used at Meteo France to do the different steps (e923,PGD) are not based on cy40t1_bf.05 but on the following
          - PGD: ms40_pgd-op2.08.IMPI500IFC1301.2x.exe, for generating the SURFEX physiography file
          - E923: cy40_master-op2.11.IMPI500IFC1301.2x.exe for the old style climate files
          - lfitools: xr41_lfitools-t1.04.IMPI500IFC1301.2x.exe to replace the orography in the PGD file with the filtered one from the atmospheric file
          - sfxtools ms41_sfxtools-t1.04.IMPI500IFC1301.2x.exe for FA<->LFI file conversion
        - The binaries used for HARMONIE climate generation are built from the same code base. Note that the original cy40t1_bf.05 contains two versions of pgd.F90. In HARMONIE the one under mse/programs has been used and the other one has been removed. The procedure to replace the orography is different ( through gl ) but equivalent to the lfitools procedure.
  * Various tasks
   * Usage of GMTED2010 data (Bolli) '''Completed for now'''
     * A new method to assemble the GMTED2010 tiff files based on python and gdal libraries has been implemented in [14448]. We found that there is a shift in the topography compared to GTOPO30 data. The investigation will continue and the GMTED2010 data assembled by Meteo France will be tested and evaluated.
   * Name convention of FA files, account for minutes, NTIMEFMT=1 (Bolli) '''Started'''
   * Cleanup use of CYCLE/LL versus LL/LLMAIN/LLMAIN_FREQ (ole) '''Ongoing'''
     * The change would allow a more flexible way to specify cycling frequency and forecast lengths which is required for the EPS setup. The change involves both update of mSMS functionality ( ECFLOW features ) and script changes.
   * ECFLOW settings, ECFLOW for climate runs (Daniel,Ole) '''No action'''
   * MSG ( Toon ) [wiki:MSGinit] '''Ongoing'''
   * Documentation (Eoin) '''Ongoing'''
     * Check the new structure in the [wiki/HarmonieSystemDocumentation documentation].
   * IO-server, asynchronous reading of LBC (Daniel) '''Ongoing'''
   * Benchmark status and preparations (Ole) '''Completed'''
     * The MPI/OpenMP reproducibility was checked again and it was concluded that for AROME this is achieved with EDKF but not with EDMFM for the intel based platform frost(SMHI). For vilje(MET Norway) with the same compiler we still see differences with different number of MPI tasks. Toon will look further into the EDMFM problem, see #100.
  * It was found that harmonie-40h1.1.beta.4 suffers from an increased STDV in MSLP when compared to 38h1.2. In the end if could be traced back to errors in the usage of GMTED2010 data. The default has now been switched back to GTOPO30 and harmonie-40h1.1.beta.5 will be tagged from r14467 on Monday the 16th of November.

 * Suggestions for HARMONIE technical improvements, https://hirlam.org/trac/wiki/HarmonieClimate/TechnicalImprovements
  * This was not discussed but will be handled in a video conference in December.

=== Extended ALADIN-HIRLAM system cooperation ===

 On Thursday the scope for further cooperation was discussed. As an input to the discussion the results of the T vs H reproducibility were shown, [https://hirlam.org/trac/attachment/wiki/HarmonieWorkingWeek/System201511/UA_TH_status.pdf pdf]. We could agree on a few common actions.

 * Organise a working week in the spring with the aim to revisit the possibility to use HARMONIE as a tool for common validation and also to address the reproducibility between T and H versions. It was suggested to contact Turkey and Portugal as potentially interested ALADIN countries for the exercise.

 * Address the question of handling of bugfixes for the export versions in the next ACNA webex meeting ( 14th of December ) where HIRLAM PL should be invited. It was suggested that the HIRLAM system PL, LACE system PL and the ALADIN code architect should be responsible for coordinating the gathering and testing of fixes. It was found unclear if Meteo France would manage the branch or if it could be done by others.

 * The configurations tested during the phasing were discussed and it was suggested that it would be very useful if e.g. an example ODB could be provided as examples for easier testing of e.g. CANARI, 3DVAR screening and minimization outside Meteo France. As of today we can identy three different main configuration, ALARO1, AROME-MF and AROME-HARMONIE. We suggest to include the latter one as a specific configuration inside mitraillette. To be done in connection to the CY43T1 phasing. To be addressed in the ACNA video conference.

 * To arrange regular yearly, common working weeks in a similar way as the past two years. We should aim at one common topic to work around but also give some flexibility to allow the participants to work on more general ALADIN/HIRLAM tasks like this year.

== Reference: HARMONIE working weeks ==

 * [wiki:Meetings/System System Working Weeks and Meetings]
