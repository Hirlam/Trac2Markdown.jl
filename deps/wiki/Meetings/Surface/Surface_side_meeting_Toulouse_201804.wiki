[[PageOutline]]
[[Center(begin)]]
= '''Surface side meeting on Surface processes and data assimilation''' =
''At the Joint ALADIN / HIRLAM Meeting in Toulouse, 16-20 April, 2018''

Last modified [[LastModified]]

[[Center(end)]]

== Call for meeting ==

This meeting is scheduled for 16:30-18:30 on Tuesday afternoon, April 17, 2018.

== Agenda ==

=== Follow up on Ljubljana meeting September 2017 ===

Let us recall/revisit what was concluded at our [wiki:Meetings/Surface/Surface201709 HIRLAM/ALADIN/LACE/SURFEX Surface Working Days in Ljubljana, September 18-20, 2017]

 * A SODA_V8 branch now exists in the SURFEX Git repository. As this [wiki:HirlamMeetings/Surface201610/SODA_development corresponding wiki] says: The purpose with this branch is that we can share SODA development by committing it to the repository. E.g., a recent updated setup using Sodankylä data (tower in Nothern Finland) exists where one can easily test (S)EKF with different cycling frequency, different control variables, different size of perturbations... A similar SURFEX8.1 offline setup has been installed and tested by Patrick at the ECMWF/cca machine.
 * Stefan points out that we are working on pre-processing (e.g. normalisation) of satellite data for surface assimilation in parallel. For example, both Magnus and Stefan has pre-processing scripts for ASCAT soil moisture product. It would be good if we can join around the methods used. Magnus uses a combination of bash/Fortran/CDO for this. A suggestion could be to add this to the ALADIN-HIRLAM system...
 * MESCAN settings in CANARI has been tested more since last year by Mariken (!MetNorway). May be activated in the next few months for the !MetCoOp domain...
 * Future of CANARI or alternatives:
   * Discussion on "Spatialisation of observations for surface data assimilation in the ALADIN-HIRLAM system" took place at ARSO in Ljubljana and later with ECMWF in connection to the EWGLAM meeting, October 2, 2017. [https://docs.google.com/document/d/1x7gvsz8Irvvi_4Sb2EL581H69_wOTKXS6GhHZaS0OrM/edit?usp=sharing Memory notes from these meetings can be found here].
   * Since then HIRLAM has kept the door open to look into [https://github.com/metno/gridpp gridpp], as developed by !MetNorway, as an alternative to CANARI for spatialisation of observations for surface data assimilation. See presentation given by Trygve Aspelien on Monday afternoon. 
 * cy43 development:
   * We discussed possible data sets for validation of high-resolution climate runs with cy43. Unfortunately, HIRLAM partners are not yet at the stage with cy43 where such data sets are needed. We still struggle with more technical problems of crashing simulations due to unrealistic snow or soil moisture behaviour ([wiki:Surface_physis_assimilation/New_SURFEX_options_cy43h using our wish list of SURFEX settings]). Details on progress can be found in this [http://hirlam.org/index.php/forum/2-harmonie-system/1302-cy43 HIRLAM Forum discussion].

=== Surface related presentations given in plenum ===

'''Here listed again with some comments'''

 * Trygve Aspelien: In plenum Monday afternoon: On the use of amateur weather observations in an operational nowcasting and NWP framework [http://www.umr-cnrm.fr/aladin/IMG/pdf/amateurobservationsinanoperationalnowcastingandnwpframework.pdf pdf]

 * Yann Seity: Recent work on AROME physics [http://www.umr-cnrm.fr/aladin/IMG/pdf/asm_2018_ys_v2.pdf pdf]
   * Underestimated snow melt with the D95 snow scheme. Replacing CSNOW=D95 with CSNOW=EBA gives more realistic results. EBA gives modified snow fraction calculation and snow melt formulation. 
   * Ongoing tests of ECOCLIMAP 2nd generation in AROME : OK on T2m/Hu2m after some tuning but problems on V10m over forests linked with higher trees than in Ecoclimap → need to work on the z0/drag parametrisation

 * Sander Tijm: HARMONIE-AROME forecast model developments [http://www.umr-cnrm.fr/aladin/IMG/pdf/20180417_fm_tijm.pdf pdf]
   * Tests in 40h1.2.tg2 (crude):
     * Reduced LAI (*0.5)
     * Increased Stomatal Resistance (*1.25)
     * Reduced soil moisture increments in OI (*0.33)

 * Kristian Pagh Nielsen: Testing the snow albedo sensitivity in HARMONIE-AROME [http://www.umr-cnrm.fr/aladin/IMG/pdf/nielsen_snow_albedos_20180417.pdf pdf]
   * Kristian volunteer to implement solar zenith angle dependence on snow albedo into SURFEX Explicit snow scheme. Already on its way into Crocus.

 * Patrick Le Moigne: SURFEX [http://www.umr-cnrm.fr/aladin/IMG/pdf/lemoigne_asm_tls.pdf pdf]

 * Patrick Samuelsson: Overview of HIRLAM surface activities [http://www.umr-cnrm.fr/aladin/IMG/pdf/hirlam_surface_patrick_180418.pdf pdf]

 * Camille Birman: Météo-France operational land surface analysis for NWP: current status and perspectives [http://www.umr-cnrm.fr/aladin/IMG/pdf/birman_asm_20180418.pdf pdf]
   * T2M_ISBA instead of T2M_mean for assimilation (first guess) and scores. T2M_ISBA is provided to CANARI via the atmospheric files.
   * With this change soil water content (EXP-oper) becomes less and soil temperature (EXP-oper) becomes warmer.
   * In snow analysis: Plan to use SURFEX snow density, provided to CANARI via the atmospheric files.

 * Ekaterina Kurzeneva: Performance of FLake in HARMONIE [http://www.umr-cnrm.fr/aladin/IMG/pdf/asm2018_kourzeneva_samuelsson.pdf pdf]

 * Laura Rontu: Status of subgrid-scale orography parametrizations ororad and orotur in HARMONIE-AROME [http://www.umr-cnrm.fr/aladin/IMG/pdf/rontu_asw18.pdf pdf]

 * Margarita Choulga: Anthropogenic influence to continental land surface stocks and fluxes [http://www.umr-cnrm.fr/aladin/IMG/pdf/asm2018_choulga.pdf pdf]

 * Patrick Le Moigne: ECOCLIMAP Second Generation [http://www.umr-cnrm.fr/aladin/IMG/pdf/ecosg_0904.pdf pdf]
   * Further tests will be conducted to identify and possibly adjust parameters on which uncertainties exist (Z0, RSMIN, CV, Z0_O_Z0H, ROOT DEPTH, SOIL DEPTH...). E.g., tuning of TREE_HEIGHT has already been applied. The tree height is based on global map at 1km-resolution (Simard et al., 2011, NASA). Missing data is replaced by low values since it has been noticed that the missing-value areas correspond to areas of e.g. vineyard and shrubs. Also, tree height in Simard et al. is higher than in earlier ECOCLIMAP. Therefore, Simard et al. tree height is divided by three in the calculation of vegetation roughness length.
   * This is the first guess of this new generation of surface parameters database. It belongs to all of us to use it, criticize it (no doubt on that!), and participate to its improvement and its integration into applications for the whole community. 

=== Additional presentations ===

 * Balazs Szintai
   * Use satellite LAI product in combination with SURFEX offline simulations with A-gs (prognostic LAI) (meaning full number of patches) to estimate LAI fields which are then used as input for the operational model LAI. 

 * Patrick Samuelsson: Near surface sub-grid conditions affected by a low lowest model level. Alternative approach... [https://hirlam.org/trac/attachment/wiki/Meetings/Surface/Surface_side_meeting_Toulouse_201804/Patrick_S_All_Staff_side_meeting_April_2018.pdf pdf]

=== Vegetation roughness length in SURFEX ===

There are indications that we need to reconsider the formulation of vegetation roughness in SURFEX.

==== Background ====

Fraction of vegetation, fr_veg, is specified in SURFEX subroutine veg_from_lai.F90. For most vegtypes values are simply specified but for crops a formula is used:

{{{
 fr_veg_crops = ( 1-exp(-0.6*LAI) )
}}}

Roughness length of vegetation (including also non-vegetated surfaces) is based on the height of the vegetation, h_veg, as z0_veg = 0.13 * h_veg. The height of the vegetation is specified in SURFEXv8 subroutine veg_height_from_lai.F90 and the roughness length in z0v_from_lai.F90. For some vegtypes values are simply specified but for grass/wetland, h_veg = LAI/6 (this value of 6 is a tuning coefficient), and for crops a formula is used:

{{{
 h_veg_crops = min( 2.5, zallen )
 zallen = exp( (LAI-3.5)/1.3 )
}}}

This table shows values used in SURFEX for fr_veg and h_veg and the resulting z0_veg. Some values depend on LAI so then one or two LAI values are just given here for example. Also, for trees, their height is given individually for each tree cover type. Here 15 m is assumed for tress as an example:

||= VEGTYPE               =||= fr_veg =||= h_veg (m) =||= z0_veg (m) =||
|| Bare soil               || 0        || 0.1         || 0.013        ||
|| Rock                    || 0        || 1.0         || 0.130        ||
|| Permanent snow          || 0        || 0.01        || 0.001        ||
|| Trees                   || 0.95     || ~15         || 1.950        ||
|| Grass/wetlands, LAI=3.0 || 0.95     || LAI/6=0.5   || 0.065        ||
|| Crops, LAI=0.5          || 0.26     || 0.1         || 0.013        ||
|| Crops, LAI=4.0          || 0.90     || 1.5         || 0.195        ||

If NPATCH=1 is used the table values will be area averaged to a final land-averaged value if the land part of a grid box includes more than one vegtype. 

==== Relationship between roughness and displacement height ====

According to e.g. Raupach (1994) the zero-plane displacement and the vegetation roughness length
should depend on the height of the vegetation and the density of the vegetation, usually expressed in
term of LAI.

The Raupach roughness length increases when a canopy (LAI) goes from very sparse to
sparse (LAI 0.5) and then decreases when the canopy becomes more dense (higher LAI).
The Raupach method gives in general
lower roughness lengths than ECOCLIMAP/SURFEX currently provides. Since, it may be dangerous
to dramatically change the roughness length in an operational model a better understanding of the
Raupach formulation with respect to current SURFEX formulation is needed.

Also, may it be so that we compensate high vegetation roughness length with no use of orographic roughness length??

[[Image(Roughness_LAI_hveg.png, 30%)]] 

=== Moving towards EKF ===

'''Activities are ongoing an a few institutes to replace OI by EKF, and also EnKF.'''

Patrick Samuelsson:

HIRLAM is more and more seriously looking into EKF as a replacement for OI. But there are quite some aspects which are still unclear, e.g. how to treat non-linear situations like precipitation events. Turn off assimilation totally at such occasions? But then, how about snow melt period, which is almost like a very long precipitation event…? Maybe keep assimilation for soil temperature only and deactivate those for soil moisture/ice,…. Any experience, ideas… are welcome! 

Eric Bazile:

It is just a comment based on our experience (with Dominique Giard) at GMAP before the use of ISBA 
and the soil moisture assimilation in ARPEGE/ALADIN in 1998.

With Dominique Giard, this non linear effect was really a problem or a nightmare for us
and the "pragmatic" option, still used in the operational system in ARPEGE and AROME, was to switch off
the soil moisture analysis in case of precipitation (and not only) BUT NOT the soil and surface temperature analysis.
It is not really logical but unfortunately all the tests done by switching off both components (moisture and Temperature) were "really" detrimental. After we should also remember that the precipitation used to decide
to switch on/off is the background and NOT the observation or an analysis of precipitation !  So knowing
the quality of the model-precipitation for the first hours and the spin up .... this predictor has probably
some uncertainties (!) ...

So it is really an important topic and probably more now than 20 years ago due to the use of more sophisticated scheme and more prognostic variables --> more interactions --> more consequences !!!! 

=== Upcoming meetings ===

Please report upcoming meetings:

 * [wiki:Meetings/Surface/Surface201805 HIRLAM Surface Working Week in Tromsø, Norway, May 28 - June 1, 2018]







