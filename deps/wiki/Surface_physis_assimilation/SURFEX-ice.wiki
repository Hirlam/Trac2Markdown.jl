[[PageOutline]]
[[Center(begin)]]
= '''Sea ice a la HIRLAM in SURFEX''' =
[[LastModified]]
[[Center(end)]]

'''This page is intended for communication between developers of the SURFEX sea ice and snow-on ice parametrizations.'''

----------------------------------
'''Sea ice meeting in Norrköping 2013-11-28, notes by Laura'''

In a meeting where Eric M, Patrick, Mariken, Laura, Katya, Juri and Bin participated, milestones of the HIRLAM sea ice work in SURFEX were discussed. Our aim is to introduce into SURFEX framework a simple sea ice+snow scheme from the HIRLAM model, as a first step, and High Resolution Thermodynamical Sea Ice model HIGHTSI, as a second step. The development work is parallel to the work by Meteo France to implement GELATO into SURFEX and should be done in cooperation to ensure consistency of the interfaces in SURFEX. First steps were agreed: to create this wiki page as a working site for HIRLAM sea ice modellers (Laura, done), to set up a SURFEX development branch (Patrick and Mariken, done, see below) and provide a SURFEX test case along the trajectory of research vessel Tara, which drifted within the ice of Arctic Ocean in 2008 (to be done, HIRLAM forcing by Bin and Laura, definition of OPTIONS by Juri).    

----------------------------------
'''Comments added by Patrick 2013-11-29:'''

How default SURFEX 7.3 code is:

The subroutine soil_heatdif.F90 in SURFEX “solves the 1-d diffusion of 'PTG'”. The idea is to call this subroutine from the SEA-tile part of SURFEX when ice is present. As input one needs to give this subroutine ice-characteristic values, instead of soil-characteristic values as now when it is called from e_budget in ISBA:

e_budget.F90:   CALL SOIL_HEATDIF(PTSTEP,PDZG,PDZDIF,PSOILCONDZ,

The NATURE tile soil part is treated by isba.F90 where these calls are involved:

 * CALL SOILDIF    sets soil-characteristic values, like e.g. PSOILHCAP = soil heat capacity and  PSOILCOND = soil thermal conductivity (W m-1 K-1)
 * CALL DRAG   sets e.g. PCH = drag coefficient for heat, PCD = drag coefficient for momentum, PRI = Richardson number
 * CALL E_BUDGET  calculates new prognostic values including CALL SOIL_HEATDIF
 * CALL ISBA_FLUXES  calculates fluxes, e.g. PH = sensible heat flux, PLE = latent heat flux, PUSTAR  = friction velocity

The corresponding subroutine for the SEA tile ice part is ice_sea_flux.F90 which is given ice-surface temperature and calculates fluxes (like ISBA_FLUXES). ICE_SEA_FLUX is called from three subroutines, e.g. by ECUME_SEAFLUX which now calls ICE_SEA_FLUX with PTICE = SST for the grid boxes which have ice. We wish to have a prognostic sea-ice temperature (a few layers) instead. Thus, SOIL_HEATDIF should be called in some clever way from the SEA tile code.

I have created a branch at the SURFEX repository where we can work on our sea-ice development. The branch is a copy from SURFEX trunk (quite similar to the code we used at the SURFEX course). You need access to the SURFEX repository to check out code:

svn co http://svn.cnrm-game-meteo.fr/projets/surfex/branches/HIRLAM_SEA_ICE_DEV

You can also look at the code using the [http://svn.cnrm-game-meteo.fr/viewsvn/surfex/branches/HIRLAM_SEA_ICE_DEV/ SURFEX svn web tool].

Modifications done of the default code:

I have added a MYSRC directory where Mariken's development is put. I have just modified this a little to make it compile under SURFEX7.3. Mariken has been running this using this [https://hirlam.org/trac/attachment/wiki/SURFEX-ice/OPTIONS.nam OPTIONS.nam]. I have not tested SURFEX with MYSRC code and this OPTIONS.nam myself!

My suggestion how to implement prognostic sea ice temperature is somewhat different compared to the code by Mariken. I suggest that we implement a call to a new subroutine in ecume_seaflux.F90 before call to ICE_SEA_FLUX (new call at line 230). The new subroutine should call  SOIL_HEATDIF and give back updated ice temperatures. Thus, ice temperatures should not be updated in ICE_SEA_FLUX according to me as it is written in the MYSRC code at the moment. Only the updated ice surface temperature should be input to  ICE_SEA_FLUX. Thus, I think it is better to leave the ICE_SEA_FLUX code as it is so it can be developed independently on how we do ice surface temperature.

For how to use svn you can look at this [http://svnbook.red-bean.com/en/1.7/index.html web page]. First check out code as I wrote above then look under "Basic Work Cycle" to see how you can work with svn.

-----------------------------------------

'''Tara test case'''

Please find attached a [https://hirlam.org/trac/attachment/wiki/SURFEX-ice/hirtara.tgz tarball] containing FORCING.nc, template for OPTIONS.nam and the original tools + data used for their creation. Tara ship drifted in Arctic Sea ice in spring and summer 2007. In this test package, forcing data from 1 May to 2 August have been picked from the HIRLAM RCR archive, and combined with Tara radiation measurements (SW and LW). The FORCING has been picked along the Tara trajectory and interpolated to one-hour interval, however in the OPTIONS a fixed gridpoint is given, hopefully it has not much importance. There would be a measured ice albedo and other stuff available, but at the moment there seems not to be any easy way to use them in the experiment, when the sea ice scheme does not yet exist. In the test options, a fixed SST of 270.15 is given, and the reference ECUME sea flux scheme has been used. In fact, this scheme does nothing after detecting the freezing temperature, but still produces a lot of empty prognostic output at different levels in water. Output can be plotted using the attached plotnc.py script based on Patrick's script. The next step would be to run the test case with modified options and ice scheme, according to Patrick's suggestions above. For the Tara case, standalone HIGHTSI has been run using the same HIRLAM forcing, so applicable for comparison and evaluation of the coming simple ice scheme results. Also observations by Tara are available, and articles have been published and are being written (references to appear!).

-----------------------------------------

'''Web-meeting 2014-01-10 '''

Between Trygve, Mariken, Ulf and Patrick to discuss how to cooperate on sea ice development.

Conclusions:

The sea-ice development will take place in the SURFEX repository. Trygve will create a new development branch for this which will be based on SURFEX 7.2 since that it the SURFEX version used in Metcoop. Any local SURFEX-Metcoop stuff which are not in SURFEX repository yet will be added. When this is done the sea-ice development can easily be tested in the SURFEX offline environment as well as in HARMONIE Metcoop environment.

Mariken and Sébastien will continue work on sea-ice in the new SURFEX branch and Juri will join the work when he comes to Oslo.

The sea ice branch is called http://svn.cnrm-game-meteo.fr/projets/surfex/branches/hirlam/cy38_sea_ice 
( and is a copy of http://svn.cnrm-game-meteo.fr/projets/surfex/branches/hirlam/cy38 )

-----------------------------------------

'''Comments added by Mariken 2014-01-30:'''

The sea ice branch has been updated, with the following directories added:
   - src/SEAICE - 1. version of changes to introduce a simple sea ice scheme in SURFEX
   - MY_RUN/DATA/hm55t1 - forcing data from Harmonie5.5 1. October 2011 - 31. July 2012 for 17 stations, including some in the Svalbard region
   - MY_RUN/NAMELIST/hm55t1062 - examples of namelists for hm55t1062 - Hopen - an island south east of Svalbard which has been chosen for the first experiments
   - src/FORC/my_forc_hm55t1062.F90 - for making forcing for Hopen
   - MY_RUN/KTEST/hm55t1062 - with FORCING.nc and also examples of the output 


Status
   - sea ice is diagnosed from SST. SST can be changed through variables in NAM_DATA_SEAFLUX and additional information in ascii files (sst..dat)
   - the sea ice scheme is activated through NAM_SEAFLUXn by setting CSEA_ICE=HM-1 (NONE is default) and NICE_LAYER - number of ice layers
   - the sea ice temperature is currently changed in ice_sea_flux.F90, but only in an ad hoc way to see that the effect of a change is as expected, currently NOT in SOIL_HEATDIF as intended.

-----------------------------------------

'''Sea ice plan added by Mariken 2014-03-27'''

[https://hirlam.org/trac/attachment/wiki/SURFEX-ice/plan_20140327.pdf pdf]

-----------------------------------------
'''Sea ice first steps by Yurii'''

Short [https://hirlam.org/trac/attachment/wiki/SURFEX-ice/ICE_explained.pdf presentation] about simple sea ice scheme.

SURFEX [https://hirlam.org/trac/attachment/wiki/SURFEX-ice/svalbard.tar.bz2 experiment] for 12 stations over Svalbard domain. This archive contains compiled SURFEX forcing, namelist with enabled sea ice, forcing sources, information about ice conditions and measurements from stations.
-----------------------------------------

'''Sea Ice Working days in Oslo 2014-05-19/20'''

Agenda

Monday 19 May 09-16 in Meeting room Cirrus, MET in CIENS

09-10: Flexible arrival time; the meeting room will be open and I will be there from 09. 
10-12: Status of sea ice implementation, SURFEX offline and HARMONIE experiments
       Short presentation by Yurii/Mariken and discussion of results

12-13: Lunch

13-15: Discuss further work on sea ice (and if time work together)
        - potential improvements of current scheme
        - HIGHTSI experiments on Svalbard stations?
        - offline SURFEX/ inline HARMONIE experiments
        - data assimilation of sea ice

15-16: Discuss our next steps within HIRLAM and MEtCoOp for
       - upgrade from current snow scheme (D59) and soil scheme (3-L) to 3-layers snow scheme and ISBA-DIF for soil.
       - from 1 to 2 patches?
       - MEB - very good if Patrick gives us a status of his work
       - short term actions (before next winter) to reduce underestimation of surface temperatures
       - evaluation of roughness fields in cycle 38 (SURFEX 7.2) with ECOCLIMAP-2


Tuesday 20 May 09-16 in Meeting room Flamma in CIENS

09-12: Work together e.g. on
       - SURFEX offline experiments e.g. for sea ice modelling at Svalbard stations or studies of sensitivity of roughness/emissivity/albedo at some Norwegian/Swedish stations 
       - HARMONIE experiments with sea ice model on Svalbard domain 

12-13: Lunch

13-16: Concluding discussions

Discussion notes: [https://hirlam.org/trac/attachment/wiki/SURFEX-ice/OsloNotes.pdf notes]


-----------------------------------------
''' Resources '''

Gelato document 19.5.2014 by Stephane Sénési, Meteo France [https://hirlam.org/trac/attachment/wiki/SURFEX-ice/Glt_Sfx_Report_5.pdf‎ pdf]

Poster about HIGHTSI on Baltic by Bin et al., 2014 [https://hirlam.org/trac/attachment/wiki/SURFEX-ice/Baltic_poster.pdf pdf]


-----------------------------------------
''' SURFEX PREP related to ice updates '''

Subroutines to be modified:

  - prep_seaflux.F90             Add CALL PREP_HOR_SEAFLUX_FIELD( ice_surface_temp, ice_fraction, ... )
  - prep_hor_seaflux_field.F90   Add code per each new variable.
  - prep_seaflux_grib.F90        Add code for reading the new variables
  - mode_read_grib.F90           Add a subroutine for each new variable

-----------------------------------------
''' Notes on sea ice meeting in met.no 17 November 2014'''

[https://hirlam.org/trac/attachment/wiki/SURFEX-ice/ICE_status.pdf Presentation by Yuri] about the simple ice scheme comparisons

Plans for the near future:

1. Finish reporting of the SICE scheme in HARMONIE-SURFEX and experiments

2. Implementations in HARMONIE-climate in met.no, SMHI

3. Towards pre-operational HARMONIE 38h1.2 experiments in met.no Arctic domain (), in FMI Finnish Academy Arctic project ()

4. Further work to rewrite HIGHTSI suitable for SURFEX framework to treat the evolving ice thickness as a prognostic variable, testing and comparisons

Plan for the report of Simple Ice Scheme:

Representation of sea ice in HARMONIE - evaluation of a simple ice scheme
Authors: Yuri, Mariken, Katya, Bin, Patrick, Laura

1. Introduction - ''draft by Katya, everyone together'' 

 * why sea ice is important
 * ice in present NWP 
 * more advanced thermodynamic ice models like HIGHTSI, GELATO, CICE
 * use of observations on sea ice properties in NWP
 * purpose of the study: develop and test simple ice scheme

2. Description of the models

 * Simple ice scheme - ''draft by Yurii''
   - basic approach
   - variables
   - snow on ice 
   - ice fraction (ideas from GELATO)
   - albedo(ideas from HIGHTSI)
   - limitations
   - numerical aspects ...
  
  * HIGHTSI
   - used for comparison in stand-alone
   - short summary - ''draft by Bin''
  
  Some table attached for comparison between the schemes? See the table attached to the Kilpisjärvi paper (link below)

3. Description of the experiments - ''draft by Yurii''
    
   * General
     - three kinds: SURFEX standalone, NWP HARMONIE Svalbard, HARMONIE-Climate Arctic
     - model intercomparisons
     - observations used for analysis and validation
     - some map here about domains, points?

   * SURFEX standalone in selected locations
     - description of experiments: periods, properties
      
   * HARMONIE Svalbard
     - desrciption of the experiments: periods, properties
     about data assimilation, boundaries etc
             
   * HARMONIE-Climate Arctic          
     - description of the experiments: periods, properties

4. Results and discussion, including validation - ''to be discussed together''

   * SURFEX standalone     - ''material from Yuri's presentation''
     - SICE - HIGHTSI intercomparison
     - fractions, snow, ice thickness

   * HARMONIE Svalbard
     
     - preliminary experiments with fractions, snow, ice thickness .. using 38h1.1 over small Svalbard domain January, March, April 2014
       - ''experiments done by Yuri, results to be shown and analysed''

     - comparison of reference and "final" SICE configuration over larger Svalbard domain January, April 2014
       ''experiments to be defined and run by Mariken & Juri'', to be described, including standard verification against observations
       SICE: no snow/ice fraction/ice albedo based on T_ice
     
    * HARMONIE-climate Arctic - Norwegian and/or RCA (Hilde, Patrick?)
      ????

For each series of experiments: evaluation of T2m, ice depth, ice temperature, snow depth, temperature, what else? 

5. Conclusions - ''to be discussed together''


[http://www.borenv.net/BER/pdfs/ber18/ber18-341.pdf Yu et al. 2013] Kilpisjärvi paper, where HIGHTSI and FLake are compared

----

In 2015, regular Arctic sea-ice-related HARMONIE experiments will be run in Met No over a large Arctic domain. Arctic HARMONIE experiments are planned also in FMI within a Finnish Academy project starting next year. In both, SICE should be implemented for comparison, which will also offer possibilities for development and effective collaboration between Met No and FMI researchers.
Common planning will be needed.


-----------------------------------------
== Notes on sea ice meeting at met.no 13 April 2016 ==

Recent status and plans for SICE in HARMONIE/SURFEX have been reported by Yurii [http://www.cnrm-game-meteo.fr/aladin/spip.php?article287 here] at the Joint 26th ALADIN Workshop & HIRLAM All Staff Meeting 2016, 4-8/04/2016, Lisbon, Portugal, and [https://hirlam.org/trac/wiki/HarmonieWorkingWeek/Surface201604 here] at the HIRLAM Workshop on surface data assimilation in Oslo, April, 2016.

The idea of Yurii how to initialise the temperature profile of new ice at the edge of old ice is by using the surface temperature and the vertical temperature shape of the old ice. This method is now tested but is not yet implemented in the operational version (cy38h or cy40h).

The Explicit snow scheme (3-L) as it is now available in the ISBAv8 part of our cy40 branch should be appropriate to couple to SICE. The current implementation of SICE in this branch is still connected to the SURFEXv7.3 style of snow 3-L scheme.

Yurii will study how GELATO works, including how a simplified version of GELATO may look. However, at the meeting we come to the conclusion that HIRLAM know-how on how sea ice in HARMONIE/SURFEX works is very valuable for our NWP operational needs and such need is not the focus of the GELATO developers who are more focused on climate needs, until now at least (although GELATO is intended for ARPEGE NWP). So, therefore, the present view is to support the implementation of SICE in SURFEX as an additional sea-ice model. This job has to be done by Yurii and it can become part of SURFEXv9.

Yurii's plan is to cherry-pick processes in HIGHTSI, like for example the growth of ice thickness, and implement these into SICE. HIGHTSI is written in old fashioned F77 style and we do not see a total rewriting of HIGHTSI in newer fortran style as an efficient way forward (which would be required if it should be an option in SURFEX).

Malte at METNorway is running the SURFEX 1D ocean bulk layer in test mode. It could be interesting to couple SICE with the ocean bulk layer to allow creation/disappearance of ice. 

-----------------------------------------

== Sea-ice development meeting January 23, 2017 ==

Participants: Yurii Batrak (!MetNorway) and Bin Cheng (FMI)

'''Bin summarize the discussion:'''

1) I understood from Yurii that the SICE applied ISBA surface heat balance module, so the snow was treated as SWE and so far the ice thickness remain as constant. So, I give Yurii the HIGHTSI ice bottom heat and bass balance code so Yurii is working on implement this part of HIGHTSI into SICE and the ice thickness will be time dependent.

2) We also discussed the surface albedo parameterizations. In HIGHTSI there was a sub-routine with up to 9 parameterization of surface albedo. My suggestion to Yurii is to apply simple scheme first, e.g. the Perovich (1991) to treat surface albedo value based on different surface status, such as dry-snow, wet-snow, bare-ice and melt-ice.

3) We also discussed how to treat surface snow mass balance. I understood the ISBA create surface sow-water content and if sea ice is under snow below, I suggest a simple treatment of this snow-water content, i.e. convert say 90% of it into sea ice mass, i.e. roughly 3 times thickness of this water level. The argument is such that when snow (on sea ice) was in a melting phase, it will create water that may percolate down to snow-ice interface and refrozen to be integrated to sea ice.

4) I understood the current model calculation indicate a bit too warm surface and a warm surface temperature will give incorrect feedback to the ABL. We therefore planned a case study largely based on our last year’s poster work. The SICE will be updated with bottom ice mass balance + surface snow metamorphism changes. The results will be compared with field measurement. In this case study, we will focus on two periods, Autumn to summer (FMI02 buoy drift) + Spring to Autumn (Tara Ice camp). We will apply different model setup and do comparisons.

'''Memory notes by Yurii:'''

1. Ice block

  1.1 Ice bottom heat and mass balance will be implemented in SICE in same way as it was done in HIGHTSI.

  1.2 Same applies to parametrization of ice surface melting processes.

  1.3 HIGHTSI also contains scheme to handle a case when ice melts internally without melting of surface layer. But this parametrization was considered as a too detailed for SICE and it won't be implemented (at least for now).

  1.4 For ice albedo HIGHTSI has a wide set of parametrizations from very simple to quite complex ones. I had an idea to use some kind of spectral albedo parametrization since SURFEX provides SWR as set of spectral bands (at least it's how it is coded), but Bin states that a complex albedo parametrization would require quite an accurate representation of ice state to provide realistic result and a simple scheme would be better for SICE to start from because it would be easier to adjust.

2. Snow on ice

  2.1 ISBA-ES still be used for snow block in SICE because it looks promising and I see no point to spend time on implementation of a new snow block that would be used to represent snow upon the ice.

  2.2 To close water balance, flow of melt water that is returned from ISBA-ES should be converted to ice (it could require some tuning to refreeze only some part of melted snow).

  2.3 When we have a thin layer young ice that is covered by a thick layer of snow, a snow-ice formation process could occur. Snow-ice formation is caused by sea water that is passing through brine channels within ice and mixing with lowest layers of snow. When this mixture freezes we will get some part of snow converted to ice. This process is not very important for Arctic region but still could be considered for implementation (with a low priority).

Any Other Business:

  a. prognostic ice salinity was discussed and it was stated that such parametrization could be very important for high-detailed representation of ice evolution but for our purposes such level of detail is worthless since it would require too many computational resources with a minor impact on NWP system.

  b. parametrization of melt ponds could be considered as more important than prognostic ice salinity but it would require a very fine representation of ice field.

  c. to assess effect of introduced ice thickness evolution and snow-ice formation blocks we will run a case study based on work that was done for ASM-2016 poster. We will study snow accumulation period (along FMI02 buoy trajectory) and snow melting period (along Tara ice camp trajectory).



